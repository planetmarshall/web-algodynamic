<?xml version="1.0" encoding="UTF-8" ?>
<!-- This is a WordPress eXtended RSS file generated by WordPress as an export of your site. -->
<!-- It contains information about your site's posts, pages, comments, categories, and other content. -->
<!-- You may use this file to transfer that content from one site to another. -->
<!-- This file is not intended to serve as a complete backup of your site. -->

<!-- To import this information into a WordPress site follow these steps: -->
<!-- 1. Log in to that site as an administrator. -->
<!-- 2. Go to Tools: Import in the WordPress admin panel. -->
<!-- 3. Install the "WordPress" importer from the list. -->
<!-- 4. Activate & Run Importer. -->
<!-- 5. Upload this file using the form provided on that page. -->
<!-- 6. You will first be asked to map the authors in this export file to users -->
<!--    on the site. For each author, you may choose to map to an -->
<!--    existing user on the site or to create a new user. -->
<!-- 7. WordPress will then import each of the posts, pages, comments, categories, etc. -->
<!--    contained in this file into your site. -->

<!-- generator="WordPress/3.5.1" created="2013-06-26 19:30" -->
<rss version="2.0"
	xmlns:excerpt="http://wordpress.org/export/1.2/excerpt/"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:wp="http://wordpress.org/export/1.2/"
>

<channel>
	<title>Planetmarshall</title>
	<link>http://www.planetmarshall.co.uk</link>
	<description>Andrew Marshall&#039;s blog</description>
	<pubDate>Wed, 26 Jun 2013 19:30:04 +0000</pubDate>
	<language>en-US</language>
	<wp:wxr_version>1.2</wp:wxr_version>
	<wp:base_site_url>http://www.planetmarshall.co.uk</wp:base_site_url>
	<wp:base_blog_url>http://www.planetmarshall.co.uk</wp:base_blog_url>

	<wp:author><wp:author_id>2</wp:author_id><wp:author_login>Andrew</wp:author_login><wp:author_email>planetmarshalluk@hotmail.com</wp:author_email><wp:author_display_name><![CDATA[Andrew]]></wp:author_display_name><wp:author_first_name><![CDATA[Andrew]]></wp:author_first_name><wp:author_last_name><![CDATA[Marshall]]></wp:author_last_name></wp:author>
	<wp:author><wp:author_id>1</wp:author_id><wp:author_login>admin</wp:author_login><wp:author_email>admin@planetmarshall.co.uk</wp:author_email><wp:author_display_name><![CDATA[admin]]></wp:author_display_name><wp:author_first_name><![CDATA[]]></wp:author_first_name><wp:author_last_name><![CDATA[]]></wp:author_last_name></wp:author>


	<generator>http://wordpress.org/?v=3.5.1</generator>

	<item>
		<title>New York City Marathon 2008</title>
		<link>http://www.planetmarshall.co.uk/2008/11/new-york-city-marathon-2008/</link>
		<pubDate>Wed, 19 Nov 2008 10:55:31 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=5</guid>
		<description></description>
		<content:encoded><![CDATA[[singlepic=28,150,left]<p class="pm_first"><span>O</span>n November 2nd I ran my first marathon. It remains to be seen if I will run another, but at least I'll have done New York. It really is the most awesome experience, the weather was just about perfect and the crowds from start to finish were incredible.</p>

<p>I took a package with Sports Tours International so everything was bought and paid for. Not only was this my first marathon but it was also my first trip to NYC ( If I'm going to see the city, I may as well see 26 miles of it... ) so I didn't want to have to worry about transfers and getting from A to B, but in the end I doubt this would have been much of a problem.</p>

<p>Unfortunately the route information is missing from the map below, but this <a target="_new" href="http://maps.google.com/maps/mm?q=http:%2F%2Ftrail.motionbased.com%2Ftrail%2Fkml%2Fepisode.kml%3FepisodePkValues%3D7172011&ie=UTF8&hl=en&ll=40.708422,-73.992767&spn=0.385174,0.457306&t=h&z=11">link</a> should show it accurately. Alternatively, you can <a href="http://www.planetmarshall.co.uk/files/nyc_2008.kml">download the kml</a> file directly for Google Earth.</p><!--more-->

<iframe width="425" height="450" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="http://maps.google.com/maps?f=q&amp;hl=en&amp;geocode=&amp;q=http:%2F%2Fwww.planetmarshall.co.uk%2Fnyc.xml&amp;ie=UTF8&amp;s=AARTsJq-vCBBrDYnBRqRQ41Tb4NO307Yfg&amp;ll=40.707189,-73.970947&amp;spn=0.234231,0.291824&amp;t=h&amp;z=11&amp;output=embed"></iframe><br /><small><a href="http://maps.google.com/maps/mm?q=http:%2F%2Ftrail.motionbased.com%2Ftrail%2Fkml%2Fepisode.kml%3FepisodePkValues%3D7172011&ie=UTF8&hl=en&ll=40.708422,-73.992767&spn=0.385174,0.457306&t=h&z=11" style="text-align:left">View Larger Map</a></small>

<p>[singlepic=37,150,150,right]I had been warned some months beforehand that the route was hilly ( well "undulating" would probably be fairer ) and it is, but not that I noticed at the beginning of the race such was the level of enthusiasm. The steepest climb is over the Verrazano-Narrows bridge at the beginning but the shallower, longer climb at the end through Central Park is much tougher, and is magnified by fatigue. Hill training helps but it's not enough to train when you're fresh, I think training when tired would be more beneficial and that means longer runs. My own training was interrupted by a calf problem in the last month and by a near disastrous ankle injury the weekend before, but such is the risk you take when you put in the mileage necessary during training.</p>

[singlepic=44,150,150,left]<p>I was amazed how quickly the first half of the race passed, and I put this largely down to the incredible atmosphere. The new yorkers are incredibly proud of this race, and the route is lined with crowds from start to finish. There are live bands - I high-fived a guitarist on the way round - there's the inevitable Rocky theme music and at one point a full Gospel choir. You don't get that on the Cambridge Boundary Run.</p>

<p>[singlepic=32,150,150,right]The one negative aspect was the size of the race ( about 40,000 competitors ) necessitates large-scale organization, which for us meant getting up for the buses from central Manhattan at 4.00 am and hanging around in the freezing cold until the 10.00 am start. I don't think this is really necessary, and although I had some fun getting to know some of my fellow runners I would sooner have had the extra few hours sleep and a proper breakfast. So that said, here are some other things I'll be bearing in mind if I ever do this again.</p>
<ul>
	<li>The 7.30 am Staten Island ferry is probably sufficient to get to the start on time, but if you must take the 4.00 am buses, take some warm clothing and probably a sleeping bag and a bivvy bag -  I kid you not. I raided the charity shops in the week before hand and so kept warm, but even so I looked with envious eyes upon those who were better prepared.</li>
	<li>You'll need to dump your kit at least an hour before the start, so take some clothes you can dispose of en route, like the aforementioned charity wear. I bought a fleece for £3.50 from a British Heart Foundation shop, which I quickly disposed of after coming off the Verrazano-Narrows bridge and ran the rest of the race in a singlet.</li>
	<li>Bring your own breakfast, since you can't rely on picking up more than a cup of coffee and a bagel at the start.</li>
	<li>The last few miles are uphill, and are magnified by fatigue so make sure your training takes this into account. There aren't many hills in Cambridge but even so I could have been better prepared.</li>
<li>Get your name printed on your running top, I envied the runners getting personal encouragement from the crowd toward the end of the race.</li>
	<li>Try to overcome any weird sense of British modesty and wear your medal everywhere you go for the next day. New Yorkers are incredibly proud of their race, the medal is like a VIP pass.</li>
<li>Don't trip over any tree roots the weekend before the race. If you do, Diclofenac is your friend.</li>
</ul>

<p>All in all I was pleased with my time of 3:57, particularly given the trouble I had with my ankle. Luckily a large tube of diclofenac gel and an ankle support was enough to see me through the race, plus the long straight sections of the race minimized the risk of further injury. I hope I'll be able to do this race again. No more flying economy class though. It sucks.</p>
[gallery=3] ]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>5</wp:post_id>
		<wp:post_date>2008-11-19 10:55:31</wp:post_date>
		<wp:post_date_gmt>2008-11-19 10:55:31</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>new-york-city-marathon-2008</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="marathon"><![CDATA[Marathon]]></category>
		<category domain="category" nicename="running"><![CDATA[Running]]></category>
		<category domain="post_tag" nicename="running"><![CDATA[Running]]></category>
		<category domain="category" nicename="sport"><![CDATA[Sport]]></category>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[268619476]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>5</wp:comment_id>
			<wp:comment_author><![CDATA[Rosaleen Ventisei]]></wp:comment_author>
			<wp:comment_author_email>edenrose26@ventisei.fsnet.co.uk</wp:comment_author_email>
			<wp:comment_author_url>http://</wp:comment_author_url>
			<wp:comment_author_IP>212.219.254.32</wp:comment_author_IP>
			<wp:comment_date>2008-12-10 12:20:12</wp:comment_date>
			<wp:comment_date_gmt>2008-12-10 12:20:12</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Well done Andrew, you make an old Aunty very proud]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>6</wp:comment_id>
			<wp:comment_author><![CDATA[Martin Docherty]]></wp:comment_author>
			<wp:comment_author_email>martin@physioacumen.co.uk</wp:comment_author_email>
			<wp:comment_author_url>http://www.physioacumen.co.uk</wp:comment_author_url>
			<wp:comment_author_IP>84.69.36.76</wp:comment_author_IP>
			<wp:comment_date>2009-01-18 08:45:43</wp:comment_date>
			<wp:comment_date_gmt>2009-01-18 08:45:43</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Hello mate, many congratulations on the marathon - a great effort!  I visited New York a few years back and even walking around it was a challenge.  The 4 a.m start sounded a little rough, you never were a morning person.  How long had you been training for?  Hope life's well with you, best wishes for 2009!]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>7</wp:comment_id>
			<wp:comment_author><![CDATA[PlanetMarshall &raquo; Blog Archive &raquo; London Triathlon 2008]]></wp:comment_author>
			<wp:comment_author_email></wp:comment_author_email>
			<wp:comment_author_url>http://www.planetmarshall.co.uk/2009/04/london-triathlon-2008/</wp:comment_author_url>
			<wp:comment_author_IP>208.68.171.100</wp:comment_author_IP>
			<wp:comment_date>2011-06-05 13:54:49</wp:comment_date>
			<wp:comment_date_gmt>2011-06-05 13:54:49</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[[...] three major endurance events I completed in 2008, the others being the Blenheim Triathlon and the New York Marathon, in aid of Epilepsy Research UK. I would like to thank everyone who generously sponsored me for [...] ]]></wp:comment_content>
			<wp:comment_approved>trash</wp:comment_approved>
			<wp:comment_type>pingback</wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>URM Emulator</title>
		<link>http://www.planetmarshall.co.uk/2009/01/urm-emulator/</link>
		<pubDate>Sun, 25 Jan 2009 23:22:34 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=24</guid>
		<description></description>
		<content:encoded><![CDATA[<p class="pm_first"><span>T</span>he Unlimited Register Machine (URM), designed by <a href="http://www.cambridge.org/us/catalogue/catalogue.asp?isbn=9780521294652" target="_new">Nigel Cutland</a>, is an abstraction of a computer similar to the <a href="http://en.wikipedia.org/wiki/Turing_machine" target="_new">Turing Machine</a> - but somewhat easier to get to grips with and more in tune with the operation of a modern computer processor.</p>
It also happens to be the model used by the Open University's course on <a href="http://www3.open.ac.uk/courses/bin/p12.dll?C01M381" target="_new">Mathematical Logic and Number Theory</a>, and is the reason for this article since I studied the course in 2007.

<!--more-->
<h3>Emulator</h3>
The implementation details of the emulator are quite interesting, using a mixture of Microsoft technologies including F# and Silverlight, however I will save that for another article for those interested in such things. To use the Emulator just hit Reset, enter the program and initial registers and click Step to trace through the program.
[silverlight: Urm.App.xap,400,300,false] ]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>24</wp:post_id>
		<wp:post_date>2009-01-25 23:22:34</wp:post_date>
		<wp:post_date_gmt>2009-01-25 23:22:34</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>urm-emulator</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="f"><![CDATA[F#]]></category>
		<category domain="post_tag" nicename="logic"><![CDATA[Logic]]></category>
		<category domain="category" nicename="mathematics"><![CDATA[Mathematics]]></category>
		<category domain="post_tag" nicename="mathematics"><![CDATA[Mathematics]]></category>
		<category domain="post_tag" nicename="open-university"><![CDATA[Open University]]></category>
		<category domain="post_tag" nicename="silverlight"><![CDATA[Silverlight]]></category>
		<category domain="category" nicename="software"><![CDATA[Software]]></category>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[271390379]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Oxford to Cambridge Bike Ride</title>
		<link>http://www.planetmarshall.co.uk/2009/03/oxford-to-cambridge-bike-ride/</link>
		<pubDate>Sat, 14 Mar 2009 19:56:54 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=145</guid>
		<description></description>
		<content:encoded><![CDATA[[singlepic=46,150,left]<p class="pm_first"><span>O</span>n 27th September 2008 I and three friends took part in the Hearts First Bike Ride from Oxford to Cambridge in aid of the <a target="_new" href="http://www.bhf.org.uk/get_involved/take_part_in_our_events/bike_rides.aspx">British Heart Foundation</a>. 

My friends stayed in Oxford overnight and probably started the day with a hearty breakfast. Unfortunately I had to make the start in Cambridge resulting in a 6.00am coach ride from Cambridge, a coach ride I almost missed due to a faulty alarm clock. One coffee cup and a muffin is no way to start a 90 mile bike ride ( or 86.78 according to my GPS ). I completed the ride in just shy of 5 hours, which admittedly is not that great but I use the excuse that it wasn't a race and I had no one to draft.
<!--more-->
Anyone who knows the route and takes a closer look at the map below may be wondering why I took a wrong turn in the centre of Cambridge resulting in me having to go down King St instead of the more sensible Emmanuel Rd route. This was basically because I wasn't paying attention and I still had the London to Cambridge ride in the back of my mind, which took the former route.

<iframe width="425" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="http://maps.google.co.uk/maps/ms?ie=UTF8&amp;hl=en&amp;t=h&amp;s=AARTsJq3RJq042zCg-TD6-fO2Jhh1oXiQA&amp;msa=0&amp;msid=103946667383316207439.000465181092dbc7cc1c7&amp;ll=51.9855,-0.567221&amp;spn=1.184088,2.334595&amp;z=8&amp;output=embed"></iframe><br /><small><a href="http://maps.google.co.uk/maps/ms?ie=UTF8&amp;hl=en&amp;t=h&amp;msa=0&amp;msid=103946667383316207439.000465181092dbc7cc1c7&amp;ll=51.9855,-0.567221&amp;spn=1.184088,2.334595&amp;z=8&amp;source=embed">View Larger Map</a></small>

[gallery=4]


]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>145</wp:post_id>
		<wp:post_date>2009-03-14 19:56:54</wp:post_date>
		<wp:post_date_gmt>2009-03-14 19:56:54</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>oxford-to-cambridge-bike-ride</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="cycling"><![CDATA[Cycling]]></category>
		<category domain="post_tag" nicename="cycling"><![CDATA[Cycling]]></category>
		<category domain="category" nicename="sport"><![CDATA[Sport]]></category>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[271230335]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>8</wp:comment_id>
			<wp:comment_author><![CDATA[]]></wp:comment_author>
			<wp:comment_author_email>info@businessleasez.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP></wp:comment_author_IP>
			<wp:comment_date>2011-04-07 20:15:00</wp:comment_date>
			<wp:comment_date_gmt>2011-04-07 20:15:00</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[What a story, though I imagine you grabbed something on the train or in Oxford. Did you bring home a medal for this one? I know the event is long over, but would like to know more about it all. Did you catch up with your mates, when did you start, did you stop over for a half pint, and where, and who won in what time? Had you signed for any since?]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>9</wp:comment_id>
			<wp:comment_author><![CDATA[Taylor]]></wp:comment_author>
			<wp:comment_author_email>taylor@equipment-leasing.ca</wp:comment_author_email>
			<wp:comment_author_url>http://www.equipment-leasing.ca</wp:comment_author_url>
			<wp:comment_author_IP></wp:comment_author_IP>
			<wp:comment_date>2011-04-12 20:16:00</wp:comment_date>
			<wp:comment_date_gmt>2011-04-12 20:16:00</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[90 miles on a cup of coffee and a muffin?

Are you mad?

You're supposed to be supporting heart smart activities, not outlining what not to do]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>10</wp:comment_id>
			<wp:comment_author><![CDATA[Damien]]></wp:comment_author>
			<wp:comment_author_email>russkrin@gmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://MakeMoneyUK.org.uk</wp:comment_author_url>
			<wp:comment_author_IP></wp:comment_author_IP>
			<wp:comment_date>2011-04-17 23:19:00</wp:comment_date>
			<wp:comment_date_gmt>2011-04-17 23:19:00</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[exactly. why would you do that?]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>9</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[176284097]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>45</wp:comment_id>
			<wp:comment_author><![CDATA[]]></wp:comment_author>
			<wp:comment_author_email>info@businessleasez.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP></wp:comment_author_IP>
			<wp:comment_date>2011-04-07 20:15:00</wp:comment_date>
			<wp:comment_date_gmt>2011-04-07 20:15:00</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[What a story, though I imagine you grabbed something on the train or in Oxford. Did you bring home a medal for this one? I know the event is long over, but would like to know more about it all. Did you catch up with your mates, when did you start, did you stop over for a half pint, and where, and who won in what time? Had you signed for any since?]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[180054429]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>47</wp:comment_id>
			<wp:comment_author><![CDATA[Taylor]]></wp:comment_author>
			<wp:comment_author_email>taylor@equipment-leasing.ca</wp:comment_author_email>
			<wp:comment_author_url>http://www.equipment-leasing.ca</wp:comment_author_url>
			<wp:comment_author_IP></wp:comment_author_IP>
			<wp:comment_date>2011-04-12 20:16:00</wp:comment_date>
			<wp:comment_date_gmt>2011-04-12 20:16:00</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[90 miles on a cup of coffee and a muffin?

Are you mad?

You're supposed to be supporting heart smart activities, not outlining what not to do]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[183365508]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>48</wp:comment_id>
			<wp:comment_author><![CDATA[Damien]]></wp:comment_author>
			<wp:comment_author_email>russkrin@gmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://MakeMoneyUK.org.uk</wp:comment_author_url>
			<wp:comment_author_IP></wp:comment_author_IP>
			<wp:comment_date>2011-04-17 23:19:00</wp:comment_date>
			<wp:comment_date_gmt>2011-04-17 23:19:00</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[exactly. why would you do that?]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>47</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[183365508]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[186410592]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
	</item>
	<item>
		<title>Dynamic Programming, Optimal Pub Crawls and CUDA</title>
		<link>http://www.planetmarshall.co.uk/?p=574</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=574</guid>
		<description></description>
		<content:encoded><![CDATA[<p class="pm_first">The Traveling Salesman Problem is the canonical example of the computationally 'hard' problem, with a search of the journal <a title="Traveling Salesman articles from the journal, 'Mathematical Programming'" href="http://www.springerlink.com/content/103081/?k=traveling+salesman" target="_blank">Mathematical Programming</a> alone bringing up over 100 results since 1970. Belonging to a class of problems known as NP ( formally, solvable in 'Non-deterministic polynomial time', informally just bloody hard ), it can be simply stated yet is deceptively difficult to tackle. So difficult, in fact, that exact solutions to the problem are computationally infeasible for even relatively small examples. Most recent research gives up on finding exact solutions, instead focussing on using metaheuristics to find good, though not necessarily exact, solutions to the problem.  The focus of this article, however, is on a method for finding an exact solution to small problems first published in the 1950s by Richard Bellman. It is known as Dynamic Programming.</p>
<!--more-->
<h3>The Traveling Salesman Problem</h3>
The problem itself is simple to explain. A traveling salesman has to visit a number of cities, what is the shortest route between them that visits each city exactly once, and returning to the origin? Simple to explain, deceptively complex to solve for all but the most trivial cases. For a thorough exposition of the TSP and its history, see <a title="The Traveling Salesman Problem from Georgia Tech" href="http://www.tsp.gatech.edu/" target="_blank">this site from Georgia Tech</a>.
<h3>Dynamic Programming</h3>
<a title="Richard Bellman's Wikipedia entry" href="http://en.wikipedia.org/wiki/Richard_Bellman" target="_blank">Richard Bellman</a> invented Dynamic Programming in 1953 as a method of solving scheduling problems by identifying the presence of ‘overlapping subproblems'. As an example, consider a function for generating the nth fibonacci number. The fibonacci sequence is defined as follows,

$$!{F_n}_{n=1}^infty,F_1=1,F_2=1, F_n=F_n-1+F_n-2 $$

So the first few numbers are 1,1,2,3,5,8 etc. Interpreting the mathematical definition directly leads to a recursive implementation, something like

[cpp]
int fibonacci( int n ) {
    switch(n) {
        case 0:
        case 1:
            return 1;
        default:
            return fibonacci(n-1)+fibonacci(n-2);
    }
}
[/cpp]


[singlepic id=116 w=120 float=left] The problem with this simple definition is illustrated by its dependency graph.  For example, both F(5) and F(4) require the computation of F(3), and so on, resulting in many redundant computations. These ‘overlapping subproblems’ can be easily identified and stored in advance, a technique now widely known as memoization.

[cpp]
int fibonacci( int n ) {
    switch(n) {
        case 0:
        case 1:
            return 1;
        default:
            if (fibtable[n])
                return fibtable[n];
            return fibonacci(n-1) + fibonacci(n-2);
    }
}
[/cpp]


It should be noted that if we were really interested in calculating Fibonacci numbers, there are more efficient methods – however it suffices to show the obvious benefits of Dynamic Programming versus naiive recursion.

The most obvious way to solve the TSP is by brute force enumeration of every possible route, however this has complexity O(n!), meaning that if you were to start calculating an optimal pub crawl between 20 pubs at a rate of one route per second at the moment of the big bang, you would still be going. By comparison, Bellman's method would take little over an hour, by taking advantage of the fact that, like the Fibonacci algorithm, many of the computations are redundant. The dynamic programming formulation can be specified as follows,

$$!C(S,l) = begin{cases} min_{min S-l}{C(S-l,m) + a_{ml}} &amp; lvert S rvert &gt; 2\ a_{1,S-l}+a_{S-l,m} &amp; lvert S rvert == 2end{cases}$$

As an illustration, take a simple TSP representing a pub crawl between 5 pubs, and number them 1-5. The expression above means that the shortest route can be calculated by the minimum of the routes between pubs 2-5, each route ending at a different pub, plus the distance to pub 1. This is illustrated in fig 1. The routes between pubs 2-5 in turn depend on their subroutes, continuing in a recursive fashion until we reach routes between only 2 pubs, which can be calculated explicitly.
<h3>A Minimal Hash for TSP Subroutes</h3>
The key to implementing the method is finding a way to store the calculated value of each sub problem so that it can be easily retrieved. For the Fibonacci algorithm this is trivial, as the function takes only a single integer as an index, however for Bellman's algorithm the index is an entire route. Though this could be done with a hashtable using strings as keys, for ease of use with CUDA it is preferred to find a 'minimal hash', in mathematical parlance a bijection between all subroutes of a length n and the set of positive integers $$mathbb{N}_n$$, so that simple array based storage can be used.

This is achieved by a construction known as a "Combinadic", referred to in a Microsoft article by James McCaffrey, who in turn credits the concept to Buckles and Lybanon. Note that I have taken some shortcuts from the published method, in that I don't require the combinadic values to be in lexicographical order.

If we represent a route as a tuple of an ordered set of integers $$s$$ and a zero-based index $$k$$ indicating the end node ( or pub ), the hashing function is as follows

$$!H(s,k) = k + lvert s rvertsum_i binom{s_i}{i}$$

Note that the function is a perfect hash only for all routes of the same length, that is the same value of $$lvert s rvert$$ - this is sufficient for the purpose. As an example, take the route defined by ({1,3,4,5},2), the route between pubs 1,3,4 and 5 ending at pub 4. Then we have

$$!H({1,3,4,5},2) = 2 + 4 left(binom{1}{0}+binom{3}{1}+binom{4}{2}+binom{5}{3}right)=$$

So we calculate the length of that route and store it in array location x. We can determine the array locations of the dependent routes using the same hashing function as follows : Route ({1,3,4,5},2) depends on routes ({1,3,5},0),  ({1,3,5},1) and ({1,3,5},2) which according to the hashing function have indices a, b and c resepctively. In addition to the length of the optimal route, we also want the route itself, so an extra array is kept to store the node that was used in calculating the minimum, as this will form part of the optimal route ( in the example above, we will store either node 1, 3 or 5 ). At any point in the algorithm there are a total of 4 arrays, 2 to store the results of the current calculation, and 2 to retrieve the results of the previous one.
<h3>References</h3>
<ol>
	<li><span class="p1"><a name="bellman"></a>Bellman, R. 1962. <a title="Dynamic Programming Treatment of the Travelling Salesman Problem" href="http://doi.acm.org/10.1145/321105.321111" target="_blank">Dynamic Programming Treatment of the Travelling Salesman Problem</a>. <em>Journal of the ACM</em>, 9(1), pp.61-63. </span></li>
	<li><span class="p1"><a name="held"></a>Held, M. and Karp, R.M. 1962. <a title="A Dynamic Programming Approach to Sequencing Problems" href="http://link.aip.org/link/?SMJMAP/10/196/1" target="_blank">A Dynamic Programming Approach to Sequencing Problems</a>. <em>J. Soc. Indust. and Appl. Math.</em>10(1), pp.196-210.</span></li>
	<li>http://msdn.microsoft.com/en-us/library/aa289166%28VS.71%29.aspx</li>
</ol>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>574</wp:post_id>
		<wp:post_date>2011-01-19 21:43:28</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Ben Nevis via the via the Càrn Mòr Dearg Arête, and Steall Falls</title>
		<link>http://www.planetmarshall.co.uk/?p=883</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=883</guid>
		<description></description>
		<content:encoded><![CDATA[<p class="pm_first">Following our adventures in the Lake District in January, I and a group of friends travelled to Fort William at the end of May for four days of camping in the wild with the aim of climbing Ben Nevis, this time ably assisted by someone who actually knew what they were doing - soon to be Wordsworth Trust Poet in Residence Helen Mort. Originally we had also planned to tackle the classic Ring of Steall route, but this proved to be too much for one trip, and Nevis was quite spectacular enough.</p>
There are two major routes for walkers tackling Ben Nevis, the classic Pony Track ( somewhat dismissingly known as the 'tourist route' ) and a more demanding ridge walk along the Càrn Mòr Dearg Arête ( CMD Arête for short ). Few reports on the web do this latter route justice, and none from the perspective of a fairly inexperienced walker who prior to January last did this kind of stuff as part of DofE expeditions about 15 years ago. I am also fairly sure that none of said reports consider what it's like to do the route carrying a fully loaded 65L rucksack with enough gear to be self sufficient for 4 days.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>883</wp:post_id>
		<wp:post_date>2010-06-04 11:21:06</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
	</item>
	<item>
		<title>Blenheim Triathlon 2008</title>
		<link>http://www.planetmarshall.co.uk/2008/07/blenheim_triathlon_2008/</link>
		<pubDate>Wed, 02 Jul 2008 20:00:17 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://planetmarshall.co.uk.web3.reliabledomainspace.com/?p=1</guid>
		<description></description>
		<content:encoded><![CDATA[[singlepic=26,112,150,left]
<p class="pm_first"><span>T</span>he previous incarnation of this site was described by former colleague <a href="http://www.morseweb.co.uk" target="_blank">Rob Morse</a> as being too “geeky”, as most of the content consisted of material for my Open University maths courses. So, to mitigate the inevitable geekification of PlanetMarshall, the first post of the new site will be detailing my efforts at the 2008 <a href="http://www.theblenheimtriathlon.com" target="_new">Blenheim Triathlon</a>. Just to prove that you do not need to be an obese agoraphobe with a penchant for burgers and comics featuring half naked girls riding dragons to be a computer programmer.</p>
<p>On the 8th of June 2008 I took part in my first Triathlon, consisting of a 750m open water swim, a 20km cycle and a 5k run - a distance that is amusingly known as a "Sprint".</p><!--more-->
<h3>Preparation</h3>
<p>Not being a driver myself, my mother and sister had generously agreed to drive and spend the day at Blenheim Palace, which is about 2-3 hours from Cambridge. The event had clearly been organised with military precision, so I had my timing chip, race numbers and bike racked in the transition area with plenty of time to spare. </p>
<h3>The swim</h3>

[singlepic=13,112,150,right] <p>This is, by some margin, my worst event. Thanks though to the Cambridge Triathlon Club I'd manage to get some open water swimming training in the weeks beforehand so I was at least prepared for the challenges that involves. Of course, you have to wear a wetsuit; this is compulsory and since the water was 15°C I wouldn't have wanted to be in the lake without one. Additionally, under the water you can't see a damn thing and so you need to practice "sighting", which essentially means looking where you're going once in a while to make sure you haven't gone off at a 90° angle and are swimming into some swans. This happens suprisingly often. One thing that initially worried me was the "washing machine" effect of having about 100 competitive swimmers in the water all starting at the same time, most of which are considerably stronger than me. I found this to be not so much of a problem, as there was plenty of room and no one really goes off at full pelt - I suspect that there were many other first timers there and that they were being equally conservative with their effort.</p>

Even with adequate preparation, the swim was tough. I was unable to complete the full distance in freestyle, which left me doing breast stroke for a short distance in the middle ( backstroke is disallowed for safety reasons, and butterfly would just be stupid ). Incidentally, it's quite difficult to do breaststroke because the wetsuit is so buoyant that it makes it difficult to push your chest under the water - I was also not helped by the fact that I had now started to digest the Sainsbury's pasta salad I had had in the car (note to self, eat earlier next time). I have a lot of work to do before the <a href="http://www.thelondontriathlon.com" target="_new">London Triathlon</a>, which is twice the distance, and I would like to do all of it freestyle.
<h3>T1</h3>
<p>I was glad to get the swim over with, but my initial relief after being helped out of the water by the attendants was mitigated somewhat by the 400m uphill run to the transition area. Of course, I had known about this beforehand but nothing quite prepares you for the actual experience. I kept my mind off it by attempting to dislodge my wetsuit. At this point I was pleasantly surprised to see my mother and sister cheering me on, since I had assumed they would have buggered off round the gardens and left me to it.</p>

<p>[singlepic=23,150,112,left]I had never done one of these transitions before, but it seemed a fairly straightforward affair of getting the wetsuit off and getting onto the bike. The wetsuit came off quite easily thanks to a tip I had read about putting baby oil on my ankles prior to the swim. Now, if you watch experienced competitors during this period what usually happens is that they have cycling shoes clipped to the pedals prior to starting, which they put on during the initial few seconds of the race while on the bike. My strategy was similar, in that it involved running out of T1 without having put my shoes on. Where it differed was that I did not actually have any cycling shoes, because I had decided to just cycle with conventional pedals in my running shoes, shoes that were at this point back next to my wetsuit ( note to self, get proper pedals and shoes).</p>
<h3>The cycle</h3>
<p>
Having gone back to get my shoes, I was now able to settle in and enjoy the cycle. [singlepic=18,112,150,right]Cycling is my strongest discipline, and the course at Blenheim has few if any major challenges. There are some undulating sections but nothing that would greatly tax an experienced rider. I would expect most good cyclists to belt round the 20km course in less than 30 minutes. I have no idea what my time was because at about this point I realised that in my hurry to remove the wetsuit the timing chip had come with it. If that weren't enough, I followed another rider into the transition area on the wrong lap and so had to turn round to resume the race. I contented myself with spending the remainder of the race trying to overtake people on bikes that easily cost at least 10 times what I spent on mine. Two laps later I turned into transition, correctly, picked up my missing timing chip and got settled into the run.</p>  

<h3>The run</h3>
<p>[singlepic=21,112,150,left] Since running half of the Cambridge Boundary Run in February in a fairly feeble 2:01, running was the discipline that I had probably spent most time training. Still, going straight into a 5k from quite a fast cycle is still a bit of a shock when you do it for the first time. The heat was really a factor at this point and I really began to look forward to the various places on the run at which the attendants were spraying runners with cold water. There are two laps to the run, the disadvantage of this is it's a bit demoralizing to approach the finish line on the first lap knowing you have to do it all over again. The advantage is that it gives you a chance to familiarize yourself with the course, so that when I approached the finish for the second time I was able to kick and start overtaking some of the other competitors. I stopped short of overtaking one guy right near the line though. It's not the Olympics, after all.</p>

<p>So that was that, I finished, had a great experience and finished with enough left in the tank that doing the Olympic distance race in London didn't seem impossible. Because of the timing chip mishap I didn't get accurate split times for the transitions and the bike, but my total time in the end was 1:42:37, which is not great but not that bad either for a first try. All in all I can't recommend this triathlon highly enough, my mother couldn't say enough about how well organised it was and also how well exiting the car park compared to a Robbie Williams concert.</p>
<h3>London Triathlon 2008</h3>
<p>By the way, I'll be participating in the <a href="http://www.thelondontriathlon.co.uk" target="_new">London Triathlon</a> on behalf of <a href="http://www.epilepsyresearch.org.uk" target="_new">Epilepsy Research UK</a> so if you're interested in sponsoring me you can do so securely online by following the link from JustGiving below.</p>
<a href="http://www.justgiving.com/planetmarshall" alt="Justgiving - Sponsor me!" target="_blank"><img src="http://www.justgiving.com/design/1/images/badges/justgiving_badge10.gif" border="0" width="270" height="50"></a>
<h3>Images</h3>
[gallery=1]
]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1035</wp:post_id>
		<wp:post_date>2008-07-02 20:00:17</wp:post_date>
		<wp:post_date_gmt>2008-07-02 20:00:17</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>blenheim_triathlon_2008</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="cycling"><![CDATA[Cycling]]></category>
		<category domain="post_tag" nicename="running"><![CDATA[Running]]></category>
		<category domain="category" nicename="sport"><![CDATA[Sport]]></category>
		<category domain="post_tag" nicename="swimming"><![CDATA[Swimming]]></category>
		<category domain="category" nicename="triathlon"><![CDATA[Triathlon]]></category>
		<category domain="post_tag" nicename="triathlon"><![CDATA[Triathlon]]></category>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[280947412]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>4</wp:comment_id>
			<wp:comment_author><![CDATA[PlanetMarshall &raquo; Blog Archive &raquo; London Triathlon 2008]]></wp:comment_author>
			<wp:comment_author_email></wp:comment_author_email>
			<wp:comment_author_url>http://www.planetmarshall.co.uk/2009/04/london-triathlon-2008/</wp:comment_author_url>
			<wp:comment_author_IP>208.68.171.100</wp:comment_author_IP>
			<wp:comment_date>2011-06-05 13:53:34</wp:comment_date>
			<wp:comment_date_gmt>2011-06-05 13:53:34</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[[...] 2008. This was the second of three major endurance events I completed in 2008, the others being the Blenheim Triathlon and the New York Marathon, in aid of Epilepsy Research UK. I would like to thank everyone who [...] ]]></wp:comment_content>
			<wp:comment_approved>trash</wp:comment_approved>
			<wp:comment_type>pingback</wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>Support Vector Machines, an Implementation in C++11</title>
		<link>http://www.planetmarshall.co.uk/?p=1316</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1316</guid>
		<description></description>
		<content:encoded><![CDATA[There are no shortage of implementations of SVMs on the web, for example LibSVM and SVMLight. However, these libraries are written in C and I wanted to take a more modern approach using the new features of C++11 and a Boost-style header-only library.

A straightforward sequential implementation, and parallel implementations in both OpenMP/SIMD and CUDA are discussed
<h2>The sequential implementation</h2>
<h2>A parallel implementation</h2>
<h3>OpenMP</h3>
<h3>SIMD</h3>
<h3>CUDA</h3>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1316</wp:post_id>
		<wp:post_date>2013-03-15 13:35:38</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Computational Photography with Android</title>
		<link>http://www.planetmarshall.co.uk/?p=1421</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1421</guid>
		<description></description>
		<content:encoded><![CDATA[When it comes to smartphones, I'm afraid my geek credentials aren't up to much, and I only upgraded from my traditional Nokia 6300 handset in January, to a brand new HTC Desire S. The smartphone is in essence a portable computer platform and it's quite astonishing what can be achieved.

Image Fusion



]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1421</wp:post_id>
		<wp:post_date>2012-03-01 16:38:23</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Solve You a Google Codejam Problem with Haskell for Great Good*</title>
		<link>http://www.planetmarshall.co.uk/?p=1437</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1437</guid>
		<description></description>
		<content:encoded><![CDATA[Every year Google runs a <a title="Google CodeJam" href="http://code.google.com/codejam/" target="_blank">CodeJam competition</a> for programmers with a competitive streak. There are several rounds, with the problems in each round usually being based on classic computer science problems, such as graph traversal or combinatorial optimization, with just enough variation thrown in to force you to think for yourself ( and presumably to make it tricky to use a prepackaged library function that can do it in one line of code ). Since on my list of things to do this year was to learn Haskell, I decided to use <a title="Google CodeJam 2008, Round 1" href="http://code.google.com/codejam/contest/32016/dashboard#s=p0" target="_blank">one of the previous contests</a> to make use of the language and to explore some algorithms.

* <em>This seemingly dodgy grammar is in reference to the Haskell Tutorial <a href="http://learnyouahaskell.com/" target="_blank">"Learn You a Haskell for Great Good</a>", possibly the greatest programming language tutorial ever written, and the basis of much of the work I've done here. It's available online for free, but I recommend buying a copy if only because the author deserves it.</em>

I've chosen to tackle the first and third problems ( mainly because I didn't find the second very interesting ). The third problem, 'Numbers' will be detailed in a follow up post. It was going to be part of this one but then it exploded somewhat as I went off on exploratory algorithmic tangents.
<h2>Scalar Product</h2>
<blockquote>You are given two vectors \(v_1=(x_1,x_2,\dotsb,x_n)\) and \(v_2=(y_1,y_2,\dotsb,y_n)\)...Suppose you are allowed to permute the coordinates of each vector as you wish. Choose two permutations such that the scalar product of your two new vectors is the smallest possible, and output that minimum scalar product.</blockquote>
This is classic combinatorial optimization, and can be restated in terms of the Linear Assignment problem,
<blockquote>Given a component \(x_i\) in the vector \(v_1\), assign to it a component \(y_i\) in the vector \(v_2\) such that the total cost \(\sum^n x_i y_i\) is minimized.</blockquote>
<h2>The Hungarian Algorithm</h2>
The most obvious solution is simple brute force, trying each pairwise component in turn until we find the minimum. It should be equally obvious that we can rule this out out for all but the smallest vectors as it has \(O(n!)\) complexity ( There are \(n!\) ways of permuting a vector with \(n\) elements). Fortunately there exists a much more efficient solution for this problem known as the <a title="Hungarian Algorithm from Wikipedia" href="http://en.wikipedia.org/wiki/Hungarian_algorithm" target="_blank">Hungarian Method</a>. As an example, take the vectors \(\mathbf{x}=(1,-5,3)\) and \(\mathbf{y}=(-2,1,4)\). Then write the product of each pair of components as a cost  matrix,
\[ \mathbf{x}\cdot\mathbf{y}^T =
\begin{pmatrix}
1 &amp; 2 &amp; 4 \\
-5 &amp; -10 &amp; -20 \\
3 &amp; 6 &amp; 12
\end{pmatrix}
\]

The key to the Hungarian Algorithm is the observation that adding ( or subtracting ) a constant value from any row or column does not change the nature of the solution. If we can do this in such a way so that there is a zero in the matrix for each assignment, then we have a solution.

In Haskell, we can create the cost matrix using the <a title="hmatrix 0.14" href="http://hackage.haskell.org/package/hmatrix-0.14.1.0" target="_blank">hmatrix</a> library, as follows,

[haskell]
import Numeric.LinearAlgebra

costMatrix :: ([Double],[Double]) -&gt; Matrix Double
costMatrix (u,v) = (mx u) * (trans $ mx u)
    where mx w = fromLists [w]
[/haskell]


[sourcecode light="true"]
ghci&gt; costMatrix([1,-5,3],[-2,1,4])
3&gt;&lt;3
[ -2.0, 10.0, -6.0
,  1.0, -5.0, 3.0
, 4.0, -20.0, 12.0]
[/sourcecode]

The first thing to determine is if the problem is actually solved, as it's possible that the components of the vectors could already be arranged such that the scalar product is minimized. Imagine drawing a line over one column or row of the matrix, covering its zeroes. When it requires exactly N lines where N is the size of the vector, then the problem is solved. As it happens, this actually constitutes the bulk of the algorithm - which I've decided to implement as a backtracking search. This kind of recursive approach tends to be what functional languages do best.

First we define a few utility functions

[haskell title="Get the index of the next zero in the matrix"]
nextZeroIndex :: Matrix Double -&gt; Maybe (Int,Int)
nextZeroIndex mx = 
  | isJust i = (i `div` n, i `mod` n)
  | isNothing i = Nothing
  where i = elemIndex 0.0 $ toList $ flatten mx
        n = rows mx
[/haskell]

[haskell title="A Slice is a simple type that represents a matrix row or column"]
data Slice = Row | Column
[/haskell]

[haskell title="Create a new matrix by dropping a row or column"]
dropSlice :: Matrix Double -&gt; Slice -&gt; Int -&gt; Matrix Double
dropSlice mx Row i = fromBlocks [[takeColumns (i-1) mx, dropColumns i mx]]
dropSlice mx Column i = fromBlocks [[takeRows (i-1) mx],[dropRows i mx]]
[/haskell]

We can now evaluate a cost matrix as follows

[haskell title="Determine if a cost matrix is solved"]
zeroSlices :: Matrix Double 
zeroSlices mx = 
  | nextZero == Nothing = []
  | otherwise = minimumBy (compare `on` length) [rowIndex:rowDropped,columnIndex:columnDropped]
  where nextZero = nextZeroIndex mx
        rowDropped = zeroSlices (dropSlice mx rowIndex )
        columnDropped = zeroSlices (dropSlice mx columnIndex)
        rowIndex = Row $ fst nextZero
        columnIndex = Column $ snd nextZero
[/haskell]

The zeroSlices procedure returns a list of the least number of slices required to cross all the zeros out of the matrix. Recursive functions can be tricky to describe, the diagram below illustrates how it works.

To establish this, I've decided to use a backtracking search, as such things are usually quite neat to write in functional languages. Wikipedia describes another approach. I'll write this search as a recursive function, so some termination criteria are needed.
<ol>
	<li>We cover all zeros using exactly N lines</li>
	<li>We cover all zeros using the smallest possible number of lines</li>
	<li>We exhaust all possibilities</li>
</ol>
The first step in the algorithm is to subtract from each row, the minimum value of that row. That leaves us with a zero in each row, but in this case the matrix is not solved as the zeroes in rows 1 and 3 lie in the same column.

\[
 \begin{pmatrix}
 1 & 2 & 4 \\
 -5 & -10 & -20 \\
 3 & 6 & 12
 \end{pmatrix}
 \longrightarrow
 \begin{pmatrix}
 0 & 1 & 3 \\
 15 & 10 & 0 \\
 0 & 3 & 9
 \end{pmatrix}
 \]

[haskell]
subtractMin m = fromRows [v - min | v &lt;- (toRows m), let min = minVec v ]
    where minVec v = scalar . minimum $ toList v
[/haskell]
[sourcecode]
ghci&gt; subtractMin mx
3&gt;&lt;3
[ 0.0,  1.0,  3.0,
 15.0, 10.0, 0.0,
  0.0,  3.0, 9.0]
ghci&gt; isSolved ( subtractMin mx )
False
[/sourcecode]

We then repeat the step but on the columns of the matrix.

\[
\begin{pmatrix}
0 &amp; 1 &amp; 3 \\
15 &amp; 10 &amp; 0 \\
0 &amp; 3 &amp; 9
\end{pmatrix}
\longrightarrow
\begin{pmatrix}
0 &amp; 0 &amp; 3 \\
15 &amp; 9 &amp; 0 \\
0 &amp; 2 &amp; 9
\end{pmatrix}
\]
In haskell this is done by simply performing the same step on the transposed matrix ( and transposing the result )

[sourcecode]
ghci&gt; trans . subtractMin . trans mx
3&gt;&lt;3
[ 0.0,  0.0,  3.0,
 15.0, 9.0, 0.0,
  0.0,  2.0, 9.0]
ghci&gt; isSolved ( trans . subtractMin $ trans mx )
False
[/sourcecode]

In actual fact, the first step in implementing this algorithm is determining when it is solved. Looking at the graph, we need a minimum cost 'perfect matching'. Such an outcome is illustrated below. In terms of the matrix, we need a zero in each row such that none share the same column ( or, equivalently, a zero in each column so that none share the same row ). Easy to say, not so easy to actually do. While it's immediately obvious from the 3x3 matrix above that it is solved, it's not so obvious how to scale this up to, say, a matrix with 10,000 elements.

I've opted to do this using a backtracking search. At each step we find the zeros in the current row, and then eliminate the columns containing those zeros from the rest of the matrix and continue with the next row. The problem is solved if we can reach the end of the matrix without stopping. This kind of recursive algorithm is easy to express in a functional programming language like Haskell.

[haskell]
solution :: Matrix Double -&gt; [Int]
solution mx
  | length sol == rows mx = sol
  | otherwise = []
  where sol = findZeros $ toLists mx

findZeros :: ([[Double]],Int) -&gt; [Int]
findZeros  (_,-2) = []
findZeros ((firstRow:rows),i) = i : maximumBy (compare `on` length) nextZeros
  where nextZeros = map findZeros $ zip nextRows zeroIndices
        nextRows = map row2col reducedColumns
        reducedColumns = map (reduceColumn (zip (trans rows) [0..n])) zeroIndices
        reduceColumn columns z = map fst $ filter (\(_,k)-&gt; k /= z) columns
        n = length rows
        zeroIndices = zeroElements firstRow
[/haskell]
<h2>An Image Analysis Application</h2>
Real world applications of the linear assignment problem are not hard to find, but here's one from image analysis. Say we're presented with a labeled diagram, as below. The diagram has already been segmented into its component parts ( there are various ways of doing this, but in the example below a simple unsupervised classifier such as k-means, based on colour information, would work well ). Next the goal is to associate each component with its label.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1437</wp:post_id>
		<wp:post_date>2013-06-03 18:24:05</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>post_to_facebook_timeline</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_author_message</wp:meta_key>
			<wp:meta_value><![CDATA[]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_mentioned_pages</wp:meta_key>
			<wp:meta_value><![CDATA[a:0:{}]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_mentioned_pages_message</wp:meta_key>
			<wp:meta_value><![CDATA[]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_mentioned_friends</wp:meta_key>
			<wp:meta_value><![CDATA[a:0:{}]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_mentioned_friends_message</wp:meta_key>
			<wp:meta_value><![CDATA[]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>LandScope : Building an Augmented Reality Android App from Scratch</title>
		<link>http://www.planetmarshall.co.uk/?p=1468</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1468</guid>
		<description></description>
		<content:encoded><![CDATA[<h2>Getting Positional Information</h2>
Location

Orientation and Heading

Creating a Live Camera View

Overlaying Graphics]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1468</wp:post_id>
		<wp:post_date>2012-07-03 15:43:05</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Three Months in British Columbia</title>
		<link>http://www.planetmarshall.co.uk/?p=1474</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1474</guid>
		<description></description>
		<content:encoded><![CDATA[Back in September I spent a <a href="http://www.planetmarshall.co.uk/2011/10/vancouver/" target="_blank">week in Vancouver</a> with clients, and during that time I had an opportunity to get out into the local mountains. Earlier this year I once again had the opportunity to visit Canada's wettest city, but this time for a three month period from April-June, and I was determined to make the most of it.

The company keeps an apartment ( or did until recently, I was the final occupant ) in a building known as 'Seawalk North'. I'm told it's quite small by Canadian standards, which is probably true if apartments are sized in proportion to their cars and breakfasts. It was, to me at least, a palace in a spectacular setting overlooking the harbour on False Creek, Burrard Bridge and Granville Island. The location is a magnet for the joggers, cyclists and rollerbladers  who traverse parts of the seawalk that runs from Stanley Park in the north to Kitsilano in the south. The only downside was the vast glass wall at one end of the open plan living area that provides the aforementioned views, as it has the side effect of magnifying the temperature in the apartment - though it could be argued that this is a small price to pay.
<h2>Trail Running</h2>
Missing the level of fitness I had attained since I ran the Berlin Marathon, in 2012 I had set myself the aim of running one race a month, and my temporary relocation had complicated this somewhat. April was to prove fairly straightforward, however, in that one of the largest 10k runs in the world is run every year in Vancouver at around that time, the Vancouver Sun Run.

The Sun Run, enjoyable as it is, is a road run, and not really what interests me these days. Hill running as we know it in Scotland, Fell running in England and Wales, does not really exist in Canada as their peaks are well above Munro height (3000 ft), the highest if not glaciated at least holding snow well into the summer months, and the lower slopes being heavily forested as the UK would have been thousands of years ago ( It would be difficult, though perhaps not impossible, to provide something like the Bob Graham round in Vancouver - I suggested such a thing to a peak bagger while there and shall be interested to see if the idea gains traction ). Trail running, however, is gaining popularity
<h2>Rock Climbing</h2>
The last word in climbing in the Vancouver area is Squamish, it's probably the first word as well though there are other locations. The Stawamus Chief that  is a huge granite monolith located on the outskirts of Squamish just off Highway 99, also known as The Sea to Sky Highway and possessed of some of the most spectacular road side scenery you're likely to see, though in my biased opinion I'd say that the A9 through Glencoe probably just about edges it out in this respect. 'The Chief' sports both bolted and traditionally protected routes ( by far the more common variety here in the UK ) that attract attention from climbers from all over the world. My first multi-pitch route on the Chief, and in fact my first multi-pitch route anywhere, was to be an 8 pitch variation of 'Diedre', widely regarded as one of the best routes of its grade ( YDS 5.8 ) anywhere in the world. During my stay I would also climb 'Seasoned in the Sun' (YDS 5.10a) and 'Calculus Crack' (YDS 5.8) as well as some pleasant but forgettable climbs in the Smoke Bluffs. All in all I had by now climbed far more in Canada than I had in my native Scotland, and was feeling inspired to get out a lot more as soon as I returned to the UK.
<h2>Alpine Mountaineering</h2>
I had not arrived at the best time for Alpine Mountaineering in BC's coastal ranges. The best weather for such activities are sustained periods of high pressure, which when they occur at all in that area of the world, are most likely to be experienced July-September. Those accustomed to weather conditions on the west coast of Scotland would feel right at home in south west British Columbia.

It was not long after I had arrived in Canada that I joined the British Columbia Mountaineering Club, a large club and a touch more formal than my local Jacobites MC but nonetheless friendly and well organized with a number of trips planned over the three months that I would be staying. My first attempt would be a short day climbing the North Ramp of Mt Harvey, which lies on the Howe Sound Crest Trail, the location of my brief adventure the previous Autumn.

No Torment in Tantalus]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1474</wp:post_id>
		<wp:post_date>2012-08-05 11:50:08</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>JPEG-LS Decoding in Javascript</title>
		<link>http://www.planetmarshall.co.uk/?p=1500</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1500</guid>
		<description></description>
		<content:encoded><![CDATA[]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1500</wp:post_id>
		<wp:post_date>2012-09-18 09:25:32</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Solve You a Google CodeJam Problem with Haskell for Even Greater Good</title>
		<link>http://www.planetmarshall.co.uk/?p=1578</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1578</guid>
		<description></description>
		<content:encoded><![CDATA[In a previous post I looked at using Haskell to solve a problem from Google CodeJam
<h2>Numbers</h2>
On the face of it, this is the hardest of the three problems to solve ( at least according to the statistics ). It is stated as
<blockquote>In this problem, you have to find the last three digits before the decimal point for the number \((3 + \sqrt5)^n\). For example, when n = 5, (3 + √5)5 = 3935.73982... The answer is 935.</blockquote>
As before, there are two problem sets, a smaller set where n is restricted to the range n &lt; 30, and one where n &lt; 2000000000. Now although \((3 + \sqrt5)^{30}\) is just beyond the range of 64-bit machine precision arithmetic, there are a number of<a title="Arbitrary and Dynamic Precision Libraries for Haskell" href="http://www.haskell.org/haskellwiki/Libraries_and_tools/Mathematics#Real_and_rational_numbers" target="_blank"> libraries available for Haskell providing arbitrary precision arithmetic</a>, and the performance cost for this task is minor. I have chosen Dave Lester's ERA library, since it is a self contained Haskell module, and the corresponding Haskell program that solves the problem for an easy 15 points is reassuringly short.

[code lang="haskell" gutter="1"]
import Control.Monad
import Text.Printf
import CReal

expr :: CReal -&gt; Integer
expr n =  floor((3+sqrt 5)**n) `mod` 1000

main = do
	l 	let num_items = read l
	items 	let printCase (index,value) = printf &quot;Case #%d: %03d\n&quot; index value
	mapM_ printCase $ zip [1..num_items] [ expr (read x) | x [/code]

That's basically it for the short problem, but since this is a practice test and we don't have the time constraints of the actual contest, it's instructive to go off on a bit of a tangent and ask how we would do this if we didn't have access to an arbitrary precision arithmetic library.
<h3>The Karatsuba Multiplication Algorithm</h3>
Until the 1960s the basic multiplication algorithm that we all learn by rote at school ( though we may not think of it as an algorithm, as a series of logical steps carried out to perform a task that's exactly what it is ), was thought to be optimal. It was <a title="Karatsuba Multiplication from Mathworld" href="http://mathworld.wolfram.com/KaratsubaMultiplication.html" target="_blank">Anatolii Alexeevitch Karatsuba</a> who showed that this was not the case, demonstrating  that the divide and conquer approach that is the foundation of so many efficient  algorithms ( such as <a title="Quicksort from Wikipedia" href="http://en.wikipedia.org/wiki/Quicksort" target="_blank">quicksort</a> and the <a title="The Cooley-Tukey FFT Algorithm from Wikipedia" href="http://en.wikipedia.org/wiki/Cooley%E2%80%93Tukey_FFT_algorithm" target="_blank">FFT</a> to name but two ) could be applied to multiply two numbers more efficiently.
<h3>Modular Exponentiation</h3>
However, evaluating such a formula for n = 2000000000 is quite a different matter. \((3 + \sqrt5)^{2\times 10^9}\) has some 700 million digits, the number of decimal digits for a number \(x^n\) is given by \(\lfloor \log_{10}x+1\rfloor\), way beyond what we can evaluate using a brute force method. This problem requires us to think a bit more intelligently.

Note that we are only asked for the three digits before the decimal point. This is equivalent to asking for the value of
\[
\lfloor(3 + \sqrt5)^{n}\rfloor \mod 1000
\]

This is tantalisingly close to a well studied problem in cryptography; modular exponentiation. The only difference here ( and what stops us using a prepackaged method from GMP or similar ) is that we have to exponentiate a floating point number.

It's the modulus function that makes this problem tractable, allowing us to reduce n to something much more manageable. We do this by first representing n in base-2, or binary, notation, something which is already done for free merely through virtue of using a digital computer.

As an example, lets take n = 178934639. In binary notation, this is 1010101010100101001101101111, or
\[
\begin{align*}
178934639_{10} &amp;= 1010101010100101001101101111_2 \\
&amp;= \sum_{i=0}^{27} a_i 2^i
\end{align*}
\]

How does this representation help us?]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1578</wp:post_id>
		<wp:post_date>2012-09-26 13:19:10</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>OSPosition : Building an Android App</title>
		<link>http://www.planetmarshall.co.uk/?p=1635</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1635</guid>
		<description></description>
		<content:encoded><![CDATA[<div>The purpose of OSPosition is to display GPS Coordinates and accuracy in a variety of formats, mainly UK National Grid for use with Ordnance Survey maps.</div>
<ul>
	<li>Use of location sensors</li>
	<li>Use of the NDK to incorporate an external library (<a title="GeographicLib" href="http://geographiclib.sourceforge.net/" target="_blank">GeographicLib</a>)</li>
</ul>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1635</wp:post_id>
		<wp:post_date>2012-10-22 10:29:38</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_mentioned_pages</wp:meta_key>
			<wp:meta_value><![CDATA[a:0:{}]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_mentioned_pages_message</wp:meta_key>
			<wp:meta_value><![CDATA[]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_mentioned_friends</wp:meta_key>
			<wp:meta_value><![CDATA[a:0:{}]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_mentioned_friends_message</wp:meta_key>
			<wp:meta_value><![CDATA[]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_author_message</wp:meta_key>
			<wp:meta_value><![CDATA[]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Predicting the outcome of a reality show</title>
		<link>http://www.planetmarshall.co.uk/?p=1639</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1639</guid>
		<description></description>
		<content:encoded><![CDATA[In November 2012, Chris Taylor correctly predicted 50/51 of the electoral college votes in the US election, using a far simpler model than the one that has been much publicized by Nate Silver in the Washington Post. I had enough confidence in Chris' model to put my money where his mouth was and bought some shares on InTrade's prediction market, and making a small profit.

This led me to wonder just what other popularity contests might lend themselves to a mathematical analysis. Enter the BBC's <em>Strictly Come Dancing</em>, 2012.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1639</wp:post_id>
		<wp:post_date>2012-11-07 14:05:53</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_mentioned_pages</wp:meta_key>
			<wp:meta_value><![CDATA[a:0:{}]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_mentioned_pages_message</wp:meta_key>
			<wp:meta_value><![CDATA[]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_mentioned_friends</wp:meta_key>
			<wp:meta_value><![CDATA[a:0:{}]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_mentioned_friends_message</wp:meta_key>
			<wp:meta_value><![CDATA[]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_author_message</wp:meta_key>
			<wp:meta_value><![CDATA[]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Can Stephen Fry Predict the FTSE 100?</title>
		<link>http://www.planetmarshall.co.uk/?p=1676</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1676</guid>
		<description></description>
		<content:encoded><![CDATA[]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1676</wp:post_id>
		<wp:post_date>2013-02-21 13:28:44</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>DIY Portfolio Optimization with Exchange Traded Funds</title>
		<link>http://www.planetmarshall.co.uk/?p=1694</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1694</guid>
		<description></description>
		<content:encoded><![CDATA[<blockquote>It should, hopefully, go without saying that if you decide to try any of these methods with your own money then the risks, and the rewards, are entirely your own.</blockquote>
I'm a big fan of Coursera's online courses, and at the beginning of this year I took Washington University's course in Computational Finance and Financial Econometrics. This coincided with me recently reading John Kay's "The long and the short of it" and so I wanted to try my hand at investing and put my money where my mouth was.

I've decided to start simple, with two risky assets. If all goes well I may follow up this post with some more advanced techniques.
<h2>Choosing my assets</h2>
I setup an account with Barclays Stockbrokers and opened an Investment ISA, which allows me to invest up to £11k tax free from a wide choice of stocks and funds. Since it's my own money at risk here I've chosen to use Exchange Traded Funds (ETFs) as my risky assets, rather than stocks, as they are already well diversified but unlike managed funds incur no management fee.

Even so, there are a variety of ETFs to choose from. I have opted for iShares FTSE 100 and BRIC, for no particular reason. A more systematic approach migh look for the funds with the best Sharpe Ratio, but this would require writing code to scrape Barclays' website for that information, and that is not the focus of this post. The goal will simply be to achieve an equal or better rate of return than investing in only one of these assets could achieve, but at a lower risk.
<h2>Getting the data</h2>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1694</wp:post_id>
		<wp:post_date>2013-05-16 16:08:13</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Implementing an irregular grid inspired by VLSI Floorplanning</title>
		<link>http://www.planetmarshall.co.uk/?p=1748</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1748</guid>
		<description></description>
		<content:encoded><![CDATA[]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1748</wp:post_id>
		<wp:post_date>2013-03-28 15:38:13</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>post_to_facebook_timeline</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Kaggle : Whale Detection Challenge</title>
		<link>http://www.planetmarshall.co.uk/?p=1802</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1802</guid>
		<description></description>
		<content:encoded><![CDATA[]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1802</wp:post_id>
		<wp:post_date>2013-04-09 11:44:38</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>post_to_facebook_timeline</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Quasi Newton Solvers</title>
		<link>http://www.planetmarshall.co.uk/?p=1813</link>
		<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1813</guid>
		<description></description>
		<content:encoded><![CDATA[]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1813</wp:post_id>
		<wp:post_date>2013-05-06 10:10:12</wp:post_date>
		<wp:post_date_gmt>0000-00-00 00:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name></wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>post_to_facebook_timeline</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Implementation of the Reaction Diffusion Simulation </title>
		<link>http://www.planetmarshall.co.uk/2009/04/implentation-of-the-reaction-diffusion-simulation/</link>
		<pubDate>Thu, 02 Apr 2009 09:34:08 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=111</guid>
		<description></description>
		<content:encoded><![CDATA[[singlepic=65,96,left]<em>Update - This post was written before the release of <a href="http://silverlight.net/getstarted/silverlight3/default.aspx" target="_new">Silverlight 3.0b</a>, which provides a number of enhancements relevant to this implementation, such as a WriteableBitmap and Pixel Shaders</em>
<h3>Rendering</h3>
The first obstacle to implementing the <a href="http://www.planetmarshall.co.uk/index.php/2009/03/reaction-diffusion-models/">RD simulation</a> is that Silverlight 2.0 does not by default provide a means of generating dynamic images. WPF has a WriteableBitmap, but no equivalent exists in Silverlight. However, it does support PNG streams so we can dynamically update a bitmap by encoding it to PNG on the fly. For this I have used <a href="http://blogs.msdn.com/jstegman/default.aspx">Joe Stegman's</a> <a href="http://blogs.msdn.com/jstegman/archive/2008/10/27/silverlight-2-sample-updates.aspx">PNGEncoder </a>class, which I have modified slightly to deal with RGB data and to reduce memory usage.
<!--more-->
<h3>Performance notes</h3>
[singlepic=69,96,right]Performance of the simulator is dominated by the time it takes to update the arrays containing the concentration values of the chemicals. Actual rendering time is negligible, even though the image has to be dynamically encoded to a PNG file in order for Silverlight to display it. There are two ways of implementing 2D arrays in Silverlight with C#, rectangular arrays or C style jagged arrays. If this were a desktop application, the most performant method would be to use rectangular arrays and unsafe access, however that option is not available to us in Silverlight so it turns out that, for safe access, jagged arrays are faster.

For example, originally the simulation step looked like this
<pre title="Rectangular array implementation" lang="csharp">for (int j = 0; j &lt; H; j++)
{
 int jm = j != 0 ? j - 1 : H - 1;
 int jp = j != H - 1 ? j + 1 : 0;
 for (int i = 0; i &lt; W; i++)
 {
  int im = i != 0 ? i - 1 : W - 1;
  int ip = i != W - 1 ? i + 1 : 0;
  double d2u = U[j,im]+U[j,ip]+U[jm,i]+U[jp,i]-4*U[j,i];
  double d2v = V[j,im]+V[j,ip]+V[jm,i]+V[jp,i]-4*V[j,i];
  double uv2 = U[j,i]*V[j,i]*V[j,i];
  Uu[j,i] = du*d2u-uv2+F+U[j,i]*one_minus_F;
  Vv[j,i] = dv*d2v+uv2+V[j,i]*one_minus_F_minus_k;
 }
}</pre>
On my machine this took on the order of 600ms to perform 100 iterations. Using jagged arrays instead, we have the following
<pre title="Jagged array implementation" lang="csharp">for (int j = 0; j &lt; H; j++)
{
 int jm = j != 0 ? j - 1 : H - 1;
 int jp = j != H - 1 ? j + 1 : 0;
 for (int i = 0; i &lt; W; i++)
 {
  int im = i != 0 ? i - 1 : W - 1;
  int ip = i != W - 1 ? i + 1 : 0;
  double d2u = U[j][im]+U[j][ip]+U[jm][i]+U[jp][i]-4*U[j][i];
  double d2v = V[j][im]+V[j][ip]+V[jm][i]+V[jp][i]-4*V[j][i];
  double uv2 = U[j][i]*V[j][i]*V[j][i];
  Uu[j][i] = du*d2u-uv2+ F+U[j][i]*one_minus_F;
  Vv[j][i] = dv*d2v+uv2+V[j][i]*one_minus_F_minus_k;
 }
}</pre>
Just replacing the array type and making no other changes this now takes about 500ms, an improvement of about 13%. However, now that we are using jagged arrays we can do better and move the row accesses out of the inner loop.
<pre title="Jagged array with outer loop caching" lang="csharp">for (int j = 0; j &lt; H; j++)
{
 int jm = j != 0 ? j - 1 : H - 1;
 int jp = j != H - 1 ? j + 1 : 0;
 var u_m = U[jm];
 var u = U[j];
 var u_p = U[jp];
 var v_m = V[jm];
 var v = V[j];
 var v_p = V[jp];
 var uu = Uu[j];
 var vv = Vv[j];
 for (int i = 0; i &lt; W; i++)
 {
  int im = i != 0 ? i - 1 : W - 1;
  int ip = i != W - 1 ? i + 1 : 0;
  double d2u = u[im]+u[ip]+u_m[i]+u_p[i]-4*u[i];
  double d2v = v[im]+v[ip]+v_m[i]+v_p[i]-4*v[i];
  double uv2 = u[i]*v[i] *v[i];
  uu[i] = du*d2u-uv2+F+u[i]*one_minus_F;
  vv[i] = dv*d2v+uv2+v[i]*one_minus_F_minus_k;
 }
}</pre>
This brings the count down to about 330ms, an improvement of about 40% over the original implementation.

We've taken the sequential code about as far as we can go. The next step is to try to take advantage of muliple cores that may be available on the user's machine.

<!--nextpage-->
<h3>Multithreading</h3>
The graph below show the CPU activity on my dual-core machine while running 10000 iterations of the simulation. Clearly there is room for improvement.

[singlepic=54]

The most obvious approach is to do a row-wise data decomposition of the arrays typical of parallel image processing operations. The basic process is the same as that described in this <a href="http://developer.amd.com/documentation/articles/pages/8292006147.aspx" target="_new">article</a> by Larry O'Brien. The code listing is simplified, and only shows how it differs from the single threaded version. In summary, we make use of the following threading primitives:
<ul>
	<li><code>ManualResetEvent</code> provides a means of cross thread communication. It is used here to indicate that a simulation step has completed and is ready for rendering.</li>
	<li><code>Interlocked</code> provides a means of updating and reading a counter in a thread-safe manner, which we use to keep track of the number of blocks remaining to be updated.</li>
	<li><code>ThreadPool</code> is a pool of worker threads managed by the Silverlight runtime.</li>
	<li><code>WaitCallback</code> is the signature for a function that can be executed on a thread from the <code>ThreadPool</code>.</li>
</ul>
<pre lang="csharp">// the ManualResetEvent is used to signal the Main thread
// when a simulation step is done
ManualResetEvent done = new ManualResetEvent(false);
int blocksPlusOne = 1;
WaitCallback rdStepBlock = delegate(object state)
{
 int[] range= (int[])state;
 for (int j = range[0]; j &lt; range[1]; j++)
 {
   // process block as per single threaded code

  // if this is the last block unblock the thread
  int isDone = Interlocked.Decrement(ref blocksPlusOne );
  if (isDone == 0)  {  done.Set(); }
};

for (int b = 0; b &lt; NumBlocks; b++)
{
 int min = rowsPerBlock * b;
 int max = min + rowsPerBlock;
 Interlocked.Increment(ref blocksPlusOne );
 ThreadPool.QueueUserWorkItem(rdStepBlock, new int[] { min, max });
}
int isDoneAlt = Interlocked.Decrement(ref blocksPlusOne );
if (isDoneAlt == 0) { done.Set(); }

// block until done
done.WaitOne();</pre>
This graph below shows the CPU activity for this method, indicating that both cpu cores are saturated. This reduces the time for ten iterations to about 220ms. Note that the use of cross thread communication reduces the amount of code that can actually be executed in parallel, so one of the goals of parallel programming is to reduce the need for such primitives as much as possible. However, at this point the simulation is fast enough for our purposes.
[singlepic=55]
<h3>Image Generation</h3>
One useful feature is the ability to generate a high resolution PNG that can be saved to the user's computer. To do this, we generate a base64 encoding of the PNG stream and embed it inline in a new web page using the <a href="http://en.wikipedia.org/wiki/Data_URI_scheme" target="_new">data URI scheme</a>. Unfortunately, currently only Firefox appears to support streams of the required length.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>111</wp:post_id>
		<wp:post_date>2009-04-02 09:34:08</wp:post_date>
		<wp:post_date_gmt>2009-04-02 09:34:08</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>implentation-of-the-reaction-diffusion-simulation</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="c"><![CDATA[C#]]></category>
		<category domain="post_tag" nicename="silverlight"><![CDATA[Silverlight]]></category>
		<category domain="category" nicename="software"><![CDATA[Software]]></category>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[268619487]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>16</wp:comment_id>
			<wp:comment_author><![CDATA[Robert]]></wp:comment_author>
			<wp:comment_author_email>as@as.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>84.243.25.65</wp:comment_author_IP>
			<wp:comment_date>2009-09-03 06:26:41</wp:comment_date>
			<wp:comment_date_gmt>2009-09-03 06:26:41</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[An interesting SilverLight article without a sample online? Am I missing something?]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>17</wp:comment_id>
			<wp:comment_author><![CDATA[Andrew]]></wp:comment_author>
			<wp:comment_author_email>planetmarshalluk@hotmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://www.planetmarshall.co.uk</wp:comment_author_url>
			<wp:comment_author_IP>86.26.4.69</wp:comment_author_IP>
			<wp:comment_date>2009-09-07 23:16:38</wp:comment_date>
			<wp:comment_date_gmt>2009-09-07 23:16:38</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Hi Robert,

The sample is in a separate post ( it is linked at the top of the page, sorry if it wasn't obvious ). You can see it at

http://www.planetmarshall.co.uk/index.php/2009/03/reaction-diffusion-models/

I don't yet have the full code online, as I want to upgrade it to SL3 and to try and get it working with Moonlight.

Thanks,
Andrew.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>18</wp:comment_id>
			<wp:comment_author><![CDATA[PlanetMarshall &raquo; Blog Archive &raquo; Reaction-Diffusion Models]]></wp:comment_author>
			<wp:comment_author_email></wp:comment_author_email>
			<wp:comment_author_url>http://www.planetmarshall.co.uk/2009/03/reaction-diffusion-models/</wp:comment_author_url>
			<wp:comment_author_IP>208.68.171.100</wp:comment_author_IP>
			<wp:comment_date>2011-06-05 13:53:04</wp:comment_date>
			<wp:comment_date_gmt>2011-06-05 13:53:04</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[[...] is implemented with Silverlight 2.0. For full details of the implementation see the separate post. For guidance in parameter selection, see [3], or just select a preset and modify it. Note that the [...] ]]></wp:comment_content>
			<wp:comment_approved>trash</wp:comment_approved>
			<wp:comment_type>pingback</wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>Reaction-Diffusion Models</title>
		<link>http://www.planetmarshall.co.uk/2009/03/reaction-diffusion-models/</link>
		<pubDate>Mon, 23 Mar 2009 00:27:03 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=124</guid>
		<description></description>
		<content:encoded><![CDATA[[singlepic=68,96,right]<p class="pm_first"><span>O</span>ne of <a target="_new" href="http://en.wikipedia.org/wiki/Alan_Turing">Alan Turing</a>'s many contributions to mathematics and science during the 20th century was his <a href="#1_turing">1952 paper</a> on "The Chemical Basis of Morphogenesis" in which he suggested that a simple model of coupled differential equations could account for pattern formation in natural processes such as those found on animal coats. Such models are known as Reaction-Diffusion models, and take the following general form
\[
\frac{\partial}{\partial t}\mathbf{q}=\mathbf{D}\nabla^2\mathbf{q}+\mathbf{R}(\mathbf{q})
\]

<!--more-->

The equation describes how the concentration of each chemical components in q evolves as a function of the other components. I have chosen to illustrate the Gray-Scott model; the physical derivation of the reactant term is described in detail in <a href="#2_grayscott">[2]</a>, the addition of the diffusion term and the resultant behaviour in <a href="#3_pearson">[3]</a>. The model has two chemical components, U and V and is described as follows.
\[
\begin{align*}
\frac{\partial}{\partial t}U&=D_u\nabla^2U-UV^2+F(1-U) \\
\frac{\partial}{\partial t}V&=D_v\nabla^2V+UV^2-(F+k)V 
\end{align*}
\]

The model is what is knows as an activator-inhibitor model, in which one chemical acts to inhibit the growth of the other.
<h3>Simulation</h3>
The simulation is implemented with <a href="http://www.silverlight.net" target="_new">Silverlight 2.0</a>. For full details of the implementation see the separate <a href="http://www.planetmarshall.co.uk/index.php/2009/04/implentation-of-the-reaction-diffusion-simulation/">post</a>. For guidance in parameter selection, see <a href="#3_pearson">[3]</a>, or just select a preset and modify it. Note that the Png image generation feature currently requires the <a target="_new" href="http://www.mozilla.com/firefox/">Firefox</a> browser.

<object width="450" height="300"
    data="data:application/x-silverlight-2," 
    type="application/x-silverlight-2" >
    <param name="source" value="http://www.planetmarshall.co.uk/apps/rdsim/ReactionDiffusion.xap"/>
</object>
<h3>Gallery</h3>
[gallery=5]
<h3>References</h3>
<ol>
<li><a name="1_turing"></a>Turing,A.,1952. <a target="_new" href="http://www.dna.caltech.edu/courses/cs191/paperscs191/turing.pdf">The chemical basis of morphogenesis [pdf]</a>. <i>Philosophical Transactions of the Royal Society</i>, 237 pp.37-72
</li>
<li><a name="2_grayscott"></a>Gray,P. and Scott,S.K. 1985. <a href="http://www.jstor.org/stable/2881810" target="_new">Sustained Oscillations and Other Exotic Patterns of Behavior in Isothermal Reactions.</a> <i>Journal of Physical Chemistry</i>, 89 pp.22-32
</li>
<li><a name="3_pearson"></a>Pearson,J.,1993. <a href="http://www.jstor.org/stable/2881810" target="_new">Complex patterns in a simple system.</a> <i>Science</i>, 261(5118) pp.189-192
</li>
</ol>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>124</wp:post_id>
		<wp:post_date>2009-03-23 00:27:03</wp:post_date>
		<wp:post_date_gmt>2009-03-23 00:27:03</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>reaction-diffusion-models</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="c"><![CDATA[C#]]></category>
		<category domain="post_tag" nicename="differential-equations"><![CDATA[Differential Equations]]></category>
		<category domain="category" nicename="mathematics"><![CDATA[Mathematics]]></category>
		<category domain="post_tag" nicename="mathematics"><![CDATA[Mathematics]]></category>
		<category domain="post_tag" nicename="silverlight"><![CDATA[Silverlight]]></category>
		<category domain="category" nicename="software"><![CDATA[Software]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[268619532]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>11</wp:comment_id>
			<wp:comment_author><![CDATA[David Cuccia]]></wp:comment_author>
			<wp:comment_author_email>dcuccia@gmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://</wp:comment_author_url>
			<wp:comment_author_IP>128.200.57.225</wp:comment_author_IP>
			<wp:comment_date>2009-05-04 05:38:25</wp:comment_date>
			<wp:comment_date_gmt>2009-05-04 05:38:25</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Awesome!]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>12</wp:comment_id>
			<wp:comment_author><![CDATA[Andrew]]></wp:comment_author>
			<wp:comment_author_email>planetmarshalluk@hotmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://www.planetmarshall.co.uk</wp:comment_author_url>
			<wp:comment_author_IP>86.26.4.69</wp:comment_author_IP>
			<wp:comment_date>2009-05-30 20:01:50</wp:comment_date>
			<wp:comment_date_gmt>2009-05-30 20:01:50</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Featured in SilverlightCream.com, 25th April 2009.

http://geekswithblogs.net/WynApseTechnicalMusings/archive/2009/04/25.aspx]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>13</wp:comment_id>
			<wp:comment_author><![CDATA[PlanetMarshall &raquo; Blog Archive &raquo; Implementation of the Reaction Diffusion Simulation]]></wp:comment_author>
			<wp:comment_author_email></wp:comment_author_email>
			<wp:comment_author_url>http://www.planetmarshall.co.uk/2009/04/implentation-of-the-reaction-diffusion-simulation/</wp:comment_author_url>
			<wp:comment_author_IP>208.68.171.100</wp:comment_author_IP>
			<wp:comment_date>2011-06-05 13:53:50</wp:comment_date>
			<wp:comment_date_gmt>2011-06-05 13:53:50</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[[...] first obstacle to implementing the RD simulation is that Silverlight 2.0 does not by default provide a means of generating dynamic images. WPF has a [...] ]]></wp:comment_content>
			<wp:comment_approved>trash</wp:comment_approved>
			<wp:comment_type>pingback</wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[176284101]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>14</wp:comment_id>
			<wp:comment_author><![CDATA[PlanetMarshall &raquo; Blog Archive &raquo; Silverlight and CUDA interop]]></wp:comment_author>
			<wp:comment_author_email></wp:comment_author_email>
			<wp:comment_author_url>http://www.planetmarshall.co.uk/2010/01/silverlight-and-cuda-interop/</wp:comment_author_url>
			<wp:comment_author_IP>208.68.171.100</wp:comment_author_IP>
			<wp:comment_date>2011-06-05 13:56:15</wp:comment_date>
			<wp:comment_date_gmt>2011-06-05 13:56:15</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[[...] the Reaction Diffusion simulation, for this application I have chosen to use Silverlight&#039;s WriteableBitmap, introduced in Silverlight [...] ]]></wp:comment_content>
			<wp:comment_approved>trash</wp:comment_approved>
			<wp:comment_type>pingback</wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>London Triathlon 2008</title>
		<link>http://www.planetmarshall.co.uk/2009/04/london-triathlon-2008/</link>
		<pubDate>Wed, 01 Apr 2009 17:57:16 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=220</guid>
		<description></description>
		<content:encoded><![CDATA[[singlepic=61,150,right]<p class="pm_first"><span>S</span>omewhat late, since I have had pictures on my facebook profile for months, but I thought I should add a post about my experiences at the London Triathlon in August 2008. This was the second of three major endurance events I completed in 2008, the others being the <a href="http://www.planetmarshall.co.uk/index.php/2008/07/blenheim_triathlon_2008/">Blenheim Triathlon</a> and the <a href="http://www.planetmarshall.co.uk/index.php/2008/11/new-york-city-marathon-2008/">New York Marathon</a>, in aid of <a href="http://www.epilepsyresearch.org.uk/" target="_new">Epilepsy Research UK</a>. I would like to thank everyone who generously sponsored me for those events, your donations have since been passed on to the charity and will be put towards improving the quality of life for eplieptics who suffer from more severe symptoms than my own.
<!--more-->
<h3>The Joy of Weekend Engineering Works</h3>
The <a href="http://www.thelondontriathlon.co.uk/" target="_new">Mazda London Triathlon</a> was my first Olympic distance event, a 1500m swim, 40km cycle and 10k run. Since I had already had something of a dry run at Blenheim I knew largely what to expect during the race itself. this time however there were no generous family members around to provide transportation, so that was my responsibility, and I don't drive. Unfortunately, National Express or whoever was running East Anglia's railways that particular week had picked Sunday 10th August for engineering works between and Cambridge and Audley End. Audley End is a 15 mile cycle from Cambridge, quite a nice cycle on any other day, but one I could have done without on the day I'm supposed to competing in a Triathlon. If that weren't bad enough, the first train to arrive broke down and I had to wait 45 minutes for the next one. The accumulation of delays reduced the 2 hour buffer with which I had left myself to prepare to about 30 minutes and seriously threatened my participation in the race.

<h3>The Swim</h3>
[singlepic=64,150,left]Had I not participated this article would have been rather pointless, so suffice to say all problems were resolved and I made it to the ExCel centre and into Prince Albert dock for the beginning of the swim. As at Blenheim I was surprised at the number of triathletes who hadn't done any open water swimming preparation - I certainly would not have liked that to be my first experience of it. Probably the most depressing part is that the markers for the super sprint and sprint distances were still up, so my initial thought was along the lines of, Oh, its not that far. No wait, that's for the 400m race, it must be the next one. No, that's for the 750m race. The marker for the 1500m race was a blurry orange blob in the distance somewhere near Dover. 1500m, a distance I can cover in less than 5 minutes on foot, is a hell of a long way in open water. 

The start of a triathlon is a rather chaotic affair, advice is often given for novices to stay near the back and it's advice I would be inclined to take. The stronger swimmers can make the rest of us minnows feel a bit like a cat in a washing machine during the early stages. Incidentally, it was at this point that I lost my GPS, which now lies at the bottom of Prince Albert dock. Do not be tempted to take yours into the water, leave it for the cycle and the run. 

<h3>The Cycle</h3>
[singlepic=57,150,right]Whoever organizes the Mazda events seems to be intent on making the transitions as painful as possible. In Blenheim there was a 400m uphill run out of the water, in London there is a flight of stairs after the swim, which left me barely able to breathe. Nonetheless, even without the GPS, the cycle is by a huge margin my favourite event and at that time was the only part of the triathlon where I feel I can really compete and not just hold my own. I still had my rather old fashioned road bike but I had finally invested in a set of SPD pedals and, having gone through the baptism of traffic light embarassments, was keen to see what improvement they might make.

There is a certain amount of Schadenfreude to be enjoyed when overtaking someone who clearly spent more on their bicycle than some people do on their cars, with an 8 year old road bike that originally cost less than £200 ( ok, it's had a few upgrades since then ). Of course, this is just making up for the experience of being overtaken in the water by people twice my age doing breaststroke, so I cannot allow myself to feel too smug about it.

As I said, I didn't have the GPS so couldn't be too accurate about pace but I found someone who was just slightly above my standard and followed them around the route ( not too close though, drafting is illegal in most Triathlons, including this one ).
<h3>The Run</h3>
[singlepic=63,150,left]A word about T2 ( the cycle->run transition ) in the London race. The ExCel centre is huge, as anyone who's ever been to a conference there will know. Transition to the 10k run involved running around most of the perimeter of the event hall, which, from a rough calculation, is about 400m. That's just transition, and is not actually part of the run component but it is mitigated somewhat in that the actual run is slightly short of the standard 10km. This was the most difficult part of the race, as the leg muscles adapt to the difference between cycling and running and at one point I didn't think I was actually going to make it out of the conference centre. It was painful, and involved no small amount of willpower to keep going.

Once that transition period is over though the previous disciplines are forgotten and it becomes all about the run. I am a better 10k runner than I was, but even at that time I was good enough to enjoy it particularly without the blistering heat we had enjoyed at <a href="http://www.planetmarshall.co.uk/index.php/2008/07/blenheim_triathlon_2008/">Blenheim</a> in June. The difficult part is that it is a 2 lap race, so there is a psychological impact when you come to the end of the first lap and see the runners ahead of you finishing, knowing that you still have 5,000m to run. At the end of the second lap, there is a punishing uphill ramp to the finishing straight and it was at this final point that I was overtaken by someone who had decided to do a sprint finish and I still regret not taking him on. Next time.

<h3>Finish</h3>
[singlepic=60,150,right]My final time was 2:56:01, which I think was pretty good for a first effort particularly given a rather poor swim time. A final thanks to fellow triathlete Mark Oxenham who saved me the grief of a train journey home by providing transportation, and to Suzy and Anna for coming down to offer moral support.
<h3>Gallery</h3>
[gallery=6] ]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>220</wp:post_id>
		<wp:post_date>2009-04-01 17:57:16</wp:post_date>
		<wp:post_date_gmt>2009-04-01 17:57:16</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>london-triathlon-2008</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="cycling"><![CDATA[Cycling]]></category>
		<category domain="post_tag" nicename="running"><![CDATA[Running]]></category>
		<category domain="category" nicename="sport"><![CDATA[Sport]]></category>
		<category domain="post_tag" nicename="swimming"><![CDATA[Swimming]]></category>
		<category domain="category" nicename="triathlon"><![CDATA[Triathlon]]></category>
		<category domain="post_tag" nicename="triathlon"><![CDATA[Triathlon]]></category>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[268619520]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>15</wp:comment_id>
			<wp:comment_author><![CDATA[Elliot]]></wp:comment_author>
			<wp:comment_author_email>elliot.newsome@gmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>139.149.31.232</wp:comment_author_IP>
			<wp:comment_date>2009-07-07 09:47:27</wp:comment_date>
			<wp:comment_date_gmt>2009-07-07 09:47:27</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Great work sir.  I am doing the Sprint version this year (2009) and it's my first time doing a triathlon ever.  Good to get some insights from your event last year.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>Piano Recordings</title>
		<link>http://www.planetmarshall.co.uk/2009/04/piano-recordings/</link>
		<pubDate>Sun, 19 Apr 2009 17:18:44 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=268</guid>
		<description></description>
		<content:encoded><![CDATA[<br/>
<a href="http://www.planetmarshall.co.uk/music/Rach_Op3_2.mp3">Prelude in C&#x266f; Minor by Sergei Rachmaninoff.</a>
<p class="pm_first"><span>I</span>n December I had my first piano recital in nearly two years, and so I started to look into various methods that performers use to conquer performance anxiety, something which causes me a lot of grief. Lately I've been hanging around with a number of friends involved in Cambridge's thriving local music scene, and so not willing to go the beta blockers route I started thinking about doing some recordings. This way not only do I get to hear what the audience hears but it also reproduces some of the pressure that comes with performing for an audience. The audiofile above is my first effort, a recording of Sergei Rachmaninoff's Prelude in C&#x266f; Minor.</p>
<!--more-->
<p>Ok, nobody's ever going to sign me up for any recording contracts and there were a number of dodgy chords in that last section but I thought it was pretty good for a first effort. It was recorded in one take and I haven't added anything else since the whole point of this exercise is as practice for a live performance.</p>
<h3>Kit</h3>
<p>[singlepic=27,150,100,left] I spent a little under £200 ( excluding the piano and the laptop ) on the recording kit, from <a href="http://www.dv247.com/" target="_new">Digital Village</a> in Cambridge. I used an <a target="_new" href="http://www.alesis.com/io2">Alesis IO|2</a> stereo mixer attached to a laptop running a cutdown version of <a href="http://www.steinberg.net/en/products/musicproduction/cubaseessential4_product.html" target="_new">Cubase</a> that came with the mixer, and a couple of cheap microphones stuffed down the piano cabinet and secured with parcel tape. The piano is a fairly largish Kawai upright.</p>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>268</wp:post_id>
		<wp:post_date>2009-04-19 17:18:44</wp:post_date>
		<wp:post_date_gmt>2009-04-19 17:18:44</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>piano-recordings</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="music"><![CDATA[Music]]></category>
		<category domain="post_tag" nicename="music"><![CDATA[Music]]></category>
		<category domain="post_tag" nicename="piano"><![CDATA[Piano]]></category>
		<wp:postmeta>
			<wp:meta_key>enclosure</wp:meta_key>
			<wp:meta_value><![CDATA[http://www.planetmarshall.co.uk/music/Rach_Op3_2.mp3
6480795
audio/mpeg
]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Using Merged ResourceDictionaries in Silverlight Themes</title>
		<link>http://www.planetmarshall.co.uk/2009/07/using-merged-resourcedictionaries-in-silverlight-themes/</link>
		<pubDate>Wed, 29 Jul 2009 02:16:59 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=303</guid>
		<description></description>
		<content:encoded><![CDATA[<p class="pm_first"><span>S</span>ilverlight 3.0 moved its featureset closer to that of WPF by adding support for merged <a href="http://msdn.microsoft.com/en-us/library/cc903952%28VS.95%29.aspx" target="_new">Resource Dictionaries</a> and <a href="http://msdn.microsoft.com/en-us/library/system.windows.style.basedon%28VS.95%29.aspx" target="_new">Style Inheritance</a>. Without these features, developing custom templates and styles for Silverlight controls can become a bit of a copy-and-paste nightmare. Since I have used the implicit theming feature built into the <a href="http://www.codeplex.com/Silverlight" target="_new">Silverlight Toolkit</a> to make my Silverlight controls fit into the overall look and feel of this site, I was hoping that these features would enable me to refactor my themes developed for Silverlight 2.0 to be a bit less unwieldy.</p>

<!--more-->

<h3>Silverlight toolkit themes do not support merged dictionaries</h3>
Unfortunately, merged dictionaries are not supported by the Silverlight Toolkit's Themes feature - at least not as it stands. For example, the following XAML and accompanying class causes a <code>XamlParseException</code> if you try to use it.

<pre lang="xml">
<ResourceDictionary>
 <ResourceDictionary.MergedDictionaries>
  <ResourceDictionary Source="/MergedTheme;component/Styles/Button.xaml"/>
 <ResourceDictionary.MergedDictionaries>
</ResourceDictionary>
</pre>
<pre lang="csharp">
public class MergedTheme : Theme {
 public MergedTheme() : 
  base(typeof(MergedTheme).Assembly, "MergedTheme.Theme.xaml") {
  DefaultStyleKey = typeof(MergedTheme);
 }
}
</pre>

All is not lost however, since full source code is provided for the Silverlight Toolkit, so it becomes a straightforward matter to track down the problem and supply a patch. 
<h3>Writing a test to reproduce the problem</h3>
Since the toolkit comes with an accompanying test suite, we proceed in textbook <a href="http://en.wikipedia.org/wiki/Test-driven_development" target="_new">TDD</a> fashion by first writing a test that exercises the issue. We can reuse some of the existing code to do this, adding a resource dictionary containing a merged dictionary reference and adding the following test to the <code>ImplicitStyleManagerTest</code> class

<pre lang="csharp">
/// <summary>
/// Test that styles contained in a  merged dictionary can be successfully applied
/// </summary>
[TestMethod]
[Asynchronous]
[Description("Test that a dictionary contining merged dictionaries can be successfully loaded.")]
public void TestResourceDictionaryWithMergedDictionaries() {
 Uri uri = new Uri("System.Windows.Controls.Testing.Theming;
  component/ImplicitStyleManager/MergedResourceDictionary.xaml", UriKind.Relative);
 TestAuto( (stackPanel) => {
  SetResourceDictionaryUri(stackPanel, uri);
  ImplicitStyleManager.SetApplyMode(stackPanel, ImplicitStylesApplyMode.Auto);
  }, Colors.Blue);
}
</pre>
The test fails as we would expect.

[singlepic id=70 template=figure]
<h3>Fix the code to make the test pass</h3>
The Theme class works by transforming the<code> ResourceDictionary</code> xaml into a <code>ContentControl</code>. A quick glance at the xaml generated by this process in the Visual Studio debugger shows why an exception is being raised.
<pre lang="xml">
<ContentControl>
 <ContentControl.Resources>
  <ResourceDictionary.MergedDictionaries>
   <ResourceDictionary Source="[...]/ResourceDictionaryForMerge.xaml" /> 
  </ResourceDictionary.MergedDictionaries>
 </ContentControl.Resources>
</ContentControl>
</pre>

The <code>ResourceDictionary.MergedDictionaries</code> element is missing its parent <code>ResourceDictionary</code> element, so we add a couple of lines of code to ResourceParser.ParseElement to detect the element and wrap it in a <code>ResourceDictionary</code>, using LINQ to XML.

<pre lang="csharp">
private static void ParseElement(XmlReader reader, XmlWriter writer, bool checkTypes) {
 if (reader.Depth == 0) {...}
 else {
  // handle merged dictionaries by wrapping them in a ResourceDictionary element
  if (reader.Name == "ResourceDictionary.MergedDictionaries") {
   XElement parent = new XElement("ResourceDictionary");
   parent.Add(XElement.ReadFrom(reader));
   writer.WriteRaw(parent.ToString());
  }
  else { ... }
 }   
}         
</pre>
Having made the change, we rerun the test.

[singlepic id=71 template=figure]

As we would hope, our custom theme now works as expected and we also have a unit test that ensures the bug does not reoccur. Note the Xaml code above, in that the Resource Dictionary is referenced using <a href="http://msdn.microsoft.com/en-us/library/aa970069.aspx" target="_new">Pack Uri</a> syntax. This is because <code>Button.xaml</code> is compiled as a Resource, rather than Content, since the latter doesn't appear to work reliably and can result in obfuscated error messages such as <i>XamlParseException: attribute "Button.xaml" value out of range.</i>

[singlepic id=72 template=figure]

I have submitted the patch for this fix to the toolkit site on Codeplex.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>303</wp:post_id>
		<wp:post_date>2009-07-29 02:16:59</wp:post_date>
		<wp:post_date_gmt>2009-07-29 02:16:59</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>using-merged-resourcedictionaries-in-silverlight-themes</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="silverlight"><![CDATA[Silverlight]]></category>
		<category domain="category" nicename="software"><![CDATA[Software]]></category>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[268619506]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>19</wp:comment_id>
			<wp:comment_author><![CDATA[Chris Maduro]]></wp:comment_author>
			<wp:comment_author_email>chrismaduro@gmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>66.247.204.42</wp:comment_author_IP>
			<wp:comment_date>2009-09-18 20:44:43</wp:comment_date>
			<wp:comment_date_gmt>2009-09-18 20:44:43</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Is this why I cannot implicitly style controls in silverlight without using the ISM(implicit style manager) from the toolkit?
 Should I just not declare a merged dictionary in the app.xaml file. This resource dictionary is from the toolkit, and does not have any x:Key elements. And Silverlight would implicitly style the controls? Or do I have to explicitly state Style="{StaticResouce MyStyle}" on every single control????]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>20</wp:comment_id>
			<wp:comment_author><![CDATA[Andrew]]></wp:comment_author>
			<wp:comment_author_email>planetmarshalluk@hotmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://www.planetmarshall.co.uk</wp:comment_author_url>
			<wp:comment_author_IP>86.12.139.66</wp:comment_author_IP>
			<wp:comment_date>2009-09-22 11:32:38</wp:comment_date>
			<wp:comment_date_gmt>2009-09-22 11:32:38</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Hi Chris. 

In response to your question - not exactly. Silverlight, unlike WPF, simply doesn't support implicit styles out of the box - you have to use the ISM from the toolkit in order to support this. The issue covered in this post is how to get the ISM to work with merged dictionaries.

If you don't use the ISM, merged dictionaries will work fine, but as you say you will have to explicitly state the style you want to use on each control.

Cheers,
Andrew.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>21</wp:comment_id>
			<wp:comment_author><![CDATA[GA]]></wp:comment_author>
			<wp:comment_author_email>giancarlo.aguilera@fox.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>216.205.224.10</wp:comment_author_IP>
			<wp:comment_date>2009-12-28 22:54:31</wp:comment_date>
			<wp:comment_date_gmt>2009-12-28 22:54:31</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Hi Andrew,

Thanks for the great info. Do you happen to know if this is still a problem with the Nov 2009 release? I would think so since I saw no release notes to address the issue but I wanted to see if perhaps you know for sure. Also, do you happen to know if the ISM bug about explicit style settings being overwritten by ISM has been resolved in the Nov 2009 release? I am debating whether or not to use ISM for a new theme based SL3 project I am working on. Given SL4 native support for implicit styles and ISM's issue, I am wondering if perhaps I should just use explit style always, at least for now until SL4 is released.

Thanks again for your knowledge that you share.

Cheers

GA]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>22</wp:comment_id>
			<wp:comment_author><![CDATA[Andrew]]></wp:comment_author>
			<wp:comment_author_email>planetmarshalluk@hotmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://www.planetmarshall.co.uk</wp:comment_author_url>
			<wp:comment_author_IP>86.12.139.66</wp:comment_author_IP>
			<wp:comment_date>2010-01-05 11:17:21</wp:comment_date>
			<wp:comment_date_gmt>2010-01-05 11:17:21</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Thanks for your comment. 
So far as I know the issue still exists since no comment has been made on the issue at
http://silverlight.codeplex.com/WorkItem/View.aspx?WorkItemId=3427, 
but I haven't tried the latest release with SL3 since I've now moved to SL4b development.

Best of luck,
Andrew.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>23</wp:comment_id>
			<wp:comment_author><![CDATA[Josey]]></wp:comment_author>
			<wp:comment_author_email>jneidhart@iccohio.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>66.162.75.2</wp:comment_author_IP>
			<wp:comment_date>2010-07-29 19:19:45</wp:comment_date>
			<wp:comment_date_gmt>2010-07-29 19:19:45</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[The issue of not being able to implicitly call toolkit themes has been addressed in silverlight 4.0 but there is still not clear cut way to combine a toolkit theme with your own style...]]></wp:comment_content>
			<wp:comment_approved>0</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[176284166]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
	</item>
	<item>
		<title>Piano Recordings - Upright Piano</title>
		<link>http://www.planetmarshall.co.uk/2009/08/piano-recordings-upright-piano/</link>
		<pubDate>Sun, 02 Aug 2009 23:41:45 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=333</guid>
		<description></description>
		<content:encoded><![CDATA[[singlepic=73,80,left]
<p class="pm_first">This is the second in a series of attempts to do some piano recordings, a project which started out of a desire to conquer stagefright on the rare occasions that I perform in public. Increasingly I have been investigating the process in more depth, making use of Cubase and various recording techniques. The result of these investigations is this recording of Sergei Rachmaninoff's Prelude in D Major, which I performed at a recital in June. This represents probably the best recording I can achieve given my upright piano and limited knowledge of recording techniques.</p>
<!--more-->

<audio src="http://www.planetmarshall.co.uk/audio/Rach_Op23_4.mp3" controls>
Your browser does not support the audio element
</audio>

<h3>Setup</h3>
[singlepic=74,150,right] This <a href="http://www.soundonsound.com/sos/jan08/articles/pianorecording_0108.htm" target="_new">article</a> from Sound on Sound describes a number of piano recording methods, including several for upright piano. The simple fact is that an upright piano is not a suitable instrument for recording, however by following some of the advice in the article I think i have probably got the best I can from the instrument and the equipment available. The picture on the right shows the setup, which is as follows
<ul>
	<li>Kawai upright piano</li>
	<li>Alesis IO|2 stereo interface</li>
	<li>Pair AKG Perceptron 150 microphones in crossed stereo configuration</li>
	<li>Laptop computer running Cubase LE ( supplied with the Alesis hardware )</li>
</ul>
Most of the kit is quite portable, so at some point I hope to repeat the experiment with a grand piano and compare the results.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>333</wp:post_id>
		<wp:post_date>2009-08-02 23:41:45</wp:post_date>
		<wp:post_date_gmt>2009-08-02 23:41:45</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>piano-recordings-upright-piano</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="music"><![CDATA[Music]]></category>
		<category domain="post_tag" nicename="music"><![CDATA[Music]]></category>
		<category domain="post_tag" nicename="piano"><![CDATA[Piano]]></category>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[268619546]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>enclosure</wp:meta_key>
			<wp:meta_value><![CDATA[http://www.planetmarshall.co.uk/audio/Rach_Op23_4.mp3
6960708
audio/mpeg
]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>24</wp:comment_id>
			<wp:comment_author><![CDATA[Aunty Portsmouth]]></wp:comment_author>
			<wp:comment_author_email>edenrose26@ventisei.fsnet.co.uk</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>95.146.58.176</wp:comment_author_IP>
			<wp:comment_date>2010-01-24 23:07:55</wp:comment_date>
			<wp:comment_date_gmt>2010-01-24 23:07:55</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[In the words of Abba "Thank You For the Music" Have just relaxed &amp; listened - when are we to get some more?? Great]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>Searching MSDN Using Google</title>
		<link>http://www.planetmarshall.co.uk/2009/11/searching-msdn-using-google/</link>
		<pubDate>Fri, 13 Nov 2009 15:40:29 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=382</guid>
		<description></description>
		<content:encoded><![CDATA[<p class="pm_first"><span>I</span> sometimes find it useful to search MSDN directly using Google, so I wrote a search plugin using OpenSearch to make this easier. Firefox should discover the search plugin automatically - it should appear in the search drop down at the top right. Otherwise, you can just <a href="javascript:window.external.AddSearchProvider('http://www.planetmarshall.co.uk/code/google_msdn.xml')">install</a> the plugin directly. For more details, see <a href="https://developer.mozilla.org/en/Creating_OpenSearch_plugins_for_Firefox" target="_new">Creating OpenSearch plugins for Firefox.</a>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>382</wp:post_id>
		<wp:post_date>2009-11-13 15:40:29</wp:post_date>
		<wp:post_date_gmt>2009-11-13 15:40:29</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>searching-msdn-using-google</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="software"><![CDATA[Software]]></category>
	</item>
	<item>
		<title>Silverlight and CUDA interop</title>
		<link>http://www.planetmarshall.co.uk/2010/01/silverlight-and-cuda-interop/</link>
		<pubDate>Fri, 15 Jan 2010 02:11:58 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=389</guid>
		<description></description>
		<content:encoded><![CDATA[[singlepic id=78 h=96 float=right]
<em>Update - <a href="#source">source code</a> now available</em>
<p class="pm_first">Microsoft have recently released a beta of Silverlight 4, which has limited support for native interoperation using COM. Potentially, this example could be applied to any number of native interop scenarios, however for this example I have chosen to use Nvidia's CUDA technology.</p>

<blockquote>Disclaimer : This is an example of what can be done, not necessarily, and in all likelihood, an example of how it should be done.</blockquote>
<h3>About CUDA</h3>
Up until around 2001 PC graphics cards, though powerful, implemented a fixed function pipeline that limited use to whatever was exposed by the APIs, usually Direct3D or OpenGL. The addition of a programmable pixel pipeline led to the use of graphics cards for more general computation tasks; at first using shaders directly, followed by higher level GPU specific programming languages, such as Brook, SH, and later NVidia's CUDA. Most of this work was, and is, documented by the <a title="GPGPU" href="http://gpgpu.org/" target="_blank">GPGPU</a> group. <a href="http://www.nvidia.com/object/cuda_home.html#" target="_blank">NVIDIA's website</a> shows CUDA being used in a wide variety of applications but in practice it is best employed in so called "<a title="Wikipedia : Embarrassingly Parallel" href="http://en.wikipedia.org/wiki/Embarrassingly_parallel" target="_blank">embarassingly parallel</a>" problems.
<!--more-->
<h3>The demonstration application</h3>
The demo below shows a Silverlight 4 beta application, which implements a recursive gaussian filter. Note that this is not the same algorithm provided by the sample in the CUDA SDK, but a more efficient method, which is described in detail in <a href="#young">[1]</a> for those interested. The main advantage of a filter implemented in this way is that the computation time is independent of the width of the filter.
To enable CUDA interop, you'll need a CUDA compatible graphics card. Then do the following,
<ol>
	<li>Install the MFC COM application (link below). The installer should register the application with COM automatically.</li>
	<li>Right click on the Silverlight App and install it for running outside of the browser. The CUDA option should now be available from the Combo box.</li>
</ol>
Source code : <a title="Download source code" href="http://planetmarshall.co.uk/silverlight/cuda_interop/SilverlightCudaInteropDemo.zip" name="source">SilverlightCudaInteropDemo.zip</a>
<a title="Install CUDA Server application" href="http://planetmarshall.co.uk/silverlight/cuda_interop/CudaServer.msi">Install MFC COM Application (5.5 Mb)</a>
[silverlight: cuda_interop/SlCudaInteropDemo.xap,520,580,false]
<h3>The native component</h3>
The native component takes the form of a COM Automation server, implemented as a client side MFC application.
<blockquote>Note: Make sure you run Visual Studio with Administrator privileges, otherwise registering the automation server with COM will fail.</blockquote>
MFC and Automation are beyond the scope of this article, but the basic process I followed was thus
<ol>
	<li>Create an MFC Dialog application using the Wizard. Make sure to enable Automation support</li>
	<li>Add a method to the autmation interface using the add Method wizard from the Class View</li>
	<li>Add a dual interface using this <a title="TN065: Dual-Interface Support for OLE Automation Servers" href="http://msdn.microsoft.com/en-us/library/4h56szat%28VS.100%29.aspx" target="_blank">Technical Note</a> from MSDN.</li>
	<li>If you get link errors, make sure to include the output of MIDL in the application class ( the one that contains OnInitInstance). I couldn't find any reference to this step, but it's how the samples work.</li>
	<li>Make sure that the run time library options passed to nvcc and msvc match, ie they should all use a DLL or Static linking, not a mixture of both</li>
	<li>If you get stuck, take a look at the <a title="MFC Samples" href="http://msdn.microsoft.com/en-us/library/482ck6x8%28VS.100%29.aspx" target="_blank">MFC Samples</a>, particularly <a title="ACDUAL Sample: Adds Dual Interfaces to an Automation Application" href="http://msdn.microsoft.com/en-us/library/xfx55tf8%28VS.100%29.aspx" target="_blank">acdual</a>.</li>
</ol>
when you pass a native array through COM Automation, it is converted to a <a title="Array Manipulation Functions from MSDN" href="http://msdn.microsoft.com/en-us/library/ms221145%28VS.100%29.aspx" target="_blank"><code>SAFEARRAY</code></a> on the native side. Note that I couldn't find any documentation on this, I discovered it through experience. The code snippets below show sending and receiving array data between Silverlight and the MFC application.
[csharp]
// note that ComAutomationFactory has become AutomationFactory
// in Silverlight 4 RC
dynamic cuda = AutomationFactory.CreateObject(&quot;CudaServer.Application&quot;);
float[] data = new [] {1.0f, 3.14f };
dynamic retData = cuda.Process( data );
// retData is a managed float array
[/csharp]
[cpp]
VARIANT CCudaServer::Process(VARIANT &amp;amp;data)
{
  SAFEARRAY *pSrcData =  data.parray;

  // this will copy the safe array into the variant
  CComVariant var(pSrcData);

  // when we return the VARIANT containing the SAFEARRAY
  // it will be marshaled to Silverlight as a managed array
  VARIANT retVal;
  VariantInit( &amp;amp;retVal );
  var.Detach( &amp;amp;retVal );
  retVal.vt = VT_ARRAY | VT_R4;
  return retVal;
}
[/cpp]
<h3>Using MEF to implement the application</h3>
The <a title="Managed Extensibility Framework at Codeplex" href="http://www.codeplex.com/MEF" target="_blank">Managed Extensibility Framework</a> is an extensible plugin framework for .NET applications and Silverlight. I have used it to dynamically discover implementations of <code>IProcessorProvider</code> based on the permissions available to the Silverlight application. The figure below shows the component structure of the application.

[singlepic id=77 w=475 template=figure]
<h3>Performance notes</h3>
<h4>Silverlight</h4>
Unlike the <a title="My Reaction-Diffusion simulator" href="http://www.planetmarshall.co.uk/index.php/2009/03/reaction-diffusion-models/">Reaction Diffusion simulation</a>, for this application I have chosen to use Silverlight's <a title="WirteableBitmap in Silverlight 3, from MSDN" href="http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.writeablebitmap%28VS.95%29.aspx" target="_blank"><code>WriteableBitmap</code></a>, introduced in Silverlight 3, rather than <a title="Joe Stegman's PNG Encoder for Silverlight" href="http://blogs.msdn.com/jstegman/archive/2008/04/21/dynamic-image-generation-in-silverlight.aspx" target="_blank">dynamic PNG encoding</a>. This revealed an interesting performance issue when using a typical double loop to iterate over the pixels. Initial timings revealed that the vast majority of the time was spent in updating the <code>WriteableBitmap</code> rather than actually performing the image processing. The initial update loop used the <code>PixelWidth</code> and <code>PixelHeight</code> properties to bound the loop counters, taking about 200ms to iterate over the loop.
[csharp]
for (int j = 0; j &amp;lt; bmp.PixelHeight; ++j)
{
  for (int i = 0; i &amp;lt; bmp.PixelWidth; ++i)
  {
     // update pixels
   }
}
[/csharp]
By caching the bitmap properties in local variables, the timing was reduced to ~5ms. Needless to say I was shocked by how much of a difference such a seemingly trivial change made.
[csharp]
int pxWidth =  bmp.PixelWidth;
int pxHeight = bmp.PixelHeight;
for (int j = 0; j &amp;lt; pxHeight; ++j)
{
  for (int i = 0; i &amp;lt; pxWidth; ++i)
  {
     // update pixels
   }
}
[/csharp]
<h4>OLE Automation</h4>
The guidelines for building performant automation code is much the same as that for other unmanaged interop scenarios in .NET : avoid chatty interfaces. Note that this is exactly what I have not done here. In fact, the time it takes CUDA to perform the image processing is dwarfed by the time it takes to marshal the data between Silverlight and COM. This can be mitigated somewhat by splitting the blur call into two operations, one to load the image, which is called only upon initialization, and one to perform the blur.
<h4>CUDA</h4>
CUDA operations are extremely sensitive to data alignment and the order in which threads access data. Kernels should be written in such a way that threads access adjacent data elements, meaning that the row major access pattern familiar to C and C# developers would produce suboptimal performance ( sometimes by as much as an order of magnitude ). Instead, array accesses should be performed in a manner more reminiscent of FORTRAN. In addition, 2D arrays should be padded out so that threads access data elements that are correctly aligned ( see the CUDA documentation for the correct alignment values ). A full exposition of performance optimization for CUDA is really beyond the scope of this article, there are many examples in the <a title="Learn More about CUDA - NVIDIA" href="http://www.nvidia.com/object/cuda_education.html" target="_blank">NVIDIA documentation</a> although the terminology can be somewhat opaque. One of the clearest explanations I have found is this <a title="Supercomputing 2007 CUDA Tutorial" href="http://gpgpu.org/sc2007" target="_blank">presentation </a>from Mark Harris at Supercomputing 2007.
[cpp]
__global__ void kernel( float *destData, float *srcData, int stride, int height )
{
  // suboptimal access. Each thread accesses elements
 // in a striding pattern
  int rowStart = (blockDim.x*blockIdx.x+threadIdx.x)*stride;
  for ( int i = rowStart; i &amp;lt; rowStart+stride; ++i ) {
    destData[i] = srcData[i];
  }
}
[/cpp]
[cpp]
__global__ void kernel( float *destData, float *srcData, int stride, int height )
{
  // optimal access pattern, each thread accesses adjacent elements
  int colStart = blockDim.x*blockIdx.x+threadIdx.x;
  // this case, 16*sizeof(float)= 64 bytes
  for ( int i = colStart ; i &amp;lt; colStart+(stride*height); i+=stride ) {
    destData[i] = srcData[i];
  }
}
[/cpp]
<h3>References</h3>
<ol>
	<li><span class="p1"><a name="young"></a>Young, I.T. &amp; van Vliet,L.J, 1995. <a title="Recursive Implementation of the Gaussian Filter" href="http://www.sciencedirect.com/science?_ob=ArticleURL&amp;_udi=B6V18-3YS90HC-D&amp;_user=10&amp;_coverDate=06%2F30%2F1995&amp;_rdoc=2&amp;_fmt=high&amp;_orig=browse&amp;_srch=doc-info%28%23toc%235668%231995%23999559997%23172292%23FLP%23display%23Volume%29&amp;_cdi=5668&amp;_sort=d&amp;_docanchor=&amp;_ct=11&amp;_acct=C000050221&amp;_version=1&amp;_urlVersion=0&amp;_userid=10&amp;md5=cdfad44c178fc20739d26562c5f26e04" target="_blank">Recursive implementation of the Gaussian filter</a>. <em>Signal Processing</em>, 44, pp.139-151. </span></li>
</ol>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>389</wp:post_id>
		<wp:post_date>2010-01-15 02:11:58</wp:post_date>
		<wp:post_date_gmt>2010-01-15 02:11:58</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>silverlight-and-cuda-interop</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="c"><![CDATA[C#]]></category>
		<category domain="post_tag" nicename="cuda"><![CDATA[CUDA]]></category>
		<category domain="post_tag" nicename="silverlight"><![CDATA[Silverlight]]></category>
		<category domain="category" nicename="software"><![CDATA[Software]]></category>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[268619511]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>25</wp:comment_id>
			<wp:comment_author><![CDATA[Все о Microsoft Silverlight &raquo; Silverlight 4 и CUDA]]></wp:comment_author>
			<wp:comment_author_email></wp:comment_author_email>
			<wp:comment_author_url>http://silverlightru.net/silverlight-4-i-cuda</wp:comment_author_url>
			<wp:comment_author_IP>195.24.78.23</wp:comment_author_IP>
			<wp:comment_date>2010-01-17 06:59:13</wp:comment_date>
			<wp:comment_date_gmt>2010-01-17 06:59:13</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[[...] использовании Siverlight и CUDA. Оригинальная статья здесь. Очень интересный материал, даже не смотря на [...] ]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type>pingback</wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>26</wp:comment_id>
			<wp:comment_author><![CDATA[Florian Mätschke]]></wp:comment_author>
			<wp:comment_author_email>florian.maetschke@studentpartners.de</wp:comment_author_email>
			<wp:comment_author_url>http://blogs.dotnet-braunschweig.de/Florian</wp:comment_author_url>
			<wp:comment_author_IP>77.21.52.95</wp:comment_author_IP>
			<wp:comment_date>2010-01-28 03:10:28</wp:comment_date>
			<wp:comment_date_gmt>2010-01-28 03:10:28</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Nice article!

Great work!]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>27</wp:comment_id>
			<wp:comment_author><![CDATA[Sam]]></wp:comment_author>
			<wp:comment_author_email>samuel@sousa.net</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>24.202.93.188</wp:comment_author_IP>
			<wp:comment_date>2010-03-28 23:52:29</wp:comment_date>
			<wp:comment_date_gmt>2010-03-28 23:52:29</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[I would like to see your CUDA application in action but i get an error.. "This application was created for an expired Beta of Silverlight"..
I just got the latest 4. build  4.0.50303.0]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[176284167]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>28</wp:comment_id>
			<wp:comment_author><![CDATA[Andrew]]></wp:comment_author>
			<wp:comment_author_email>planetmarshalluk@hotmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://www.planetmarshall.co.uk</wp:comment_author_url>
			<wp:comment_author_IP>86.12.139.66</wp:comment_author_IP>
			<wp:comment_date>2010-03-29 09:16:25</wp:comment_date>
			<wp:comment_date_gmt>2010-03-29 09:16:25</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Hi Sam,

I'm in the process of updating the sample to the Silverlight 4 RC, it should be done shortly.

Regards,
Andrew.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>27</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>29</wp:comment_id>
			<wp:comment_author><![CDATA[Leo Camello]]></wp:comment_author>
			<wp:comment_author_email>leocamello@terra.com.br</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>187.89.25.252</wp:comment_author_IP>
			<wp:comment_date>2010-04-08 15:46:38</wp:comment_date>
			<wp:comment_date_gmt>2010-04-08 15:46:38</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Is it possible to do things like 3D rendering using this technique?]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[176284144]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>30</wp:comment_id>
			<wp:comment_author><![CDATA[Andrew]]></wp:comment_author>
			<wp:comment_author_email>planetmarshalluk@hotmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://www.planetmarshall.co.uk</wp:comment_author_url>
			<wp:comment_author_IP>86.12.139.66</wp:comment_author_IP>
			<wp:comment_date>2010-04-09 09:17:23</wp:comment_date>
			<wp:comment_date_gmt>2010-04-09 09:17:23</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Leo,
While it would be technically possible to render a scene in DirectX, say, to an off screen bitmap and then pass it back for display in Silverlight via COM, there's no way to escape the bandwidth problem that I observed in the image processing example.
You are always limited by the time it takes to transfer the data between COM and Silverlight, which I could never reduce to much less than 40ms on my system.

You might be better off investigating something like Kit3D which provides a native Silverlight 3D engine.

http://kit3d.codeplex.com/]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>29</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>31</wp:comment_id>
			<wp:comment_author><![CDATA[Leo Camello]]></wp:comment_author>
			<wp:comment_author_email>leocamello@terra.com.br</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>187.89.191.113</wp:comment_author_IP>
			<wp:comment_date>2010-04-09 17:09:41</wp:comment_date>
			<wp:comment_date_gmt>2010-04-09 17:09:41</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Thank you Andrew! =]

I'll try to investigate this Kit3D]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[176284107]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>32</wp:comment_id>
			<wp:comment_author><![CDATA[jun wei]]></wp:comment_author>
			<wp:comment_author_email>jun.ccie.wei@gmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>58.19.66.74</wp:comment_author_IP>
			<wp:comment_date>2010-07-09 14:44:37</wp:comment_date>
			<wp:comment_date_gmt>2010-07-09 14:44:37</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Please post some steps on how to build projects.]]></wp:comment_content>
			<wp:comment_approved>0</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[176284110]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>33</wp:comment_id>
			<wp:comment_author><![CDATA[jun wei]]></wp:comment_author>
			<wp:comment_author_email>jun.ccie.wei@gmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>58.19.66.74</wp:comment_author_IP>
			<wp:comment_date>2010-07-13 02:06:49</wp:comment_date>
			<wp:comment_date_gmt>2010-07-13 02:06:49</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Build error!

1&gt;C:Program FilesMSBuildMicrosoft.Cppv4.0Microsoft.CppCommon.targets(151,5): error MSB6006: "cmd.exe" exited with code -1.

 
    ]]></wp:comment_content>
			<wp:comment_approved>0</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[176284119]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>34</wp:comment_id>
			<wp:comment_author><![CDATA[jun wei]]></wp:comment_author>
			<wp:comment_author_email>jun.ccie.wei@gmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>58.19.66.74</wp:comment_author_IP>
			<wp:comment_date>2010-07-13 02:11:27</wp:comment_date>
			<wp:comment_date_gmt>2010-07-13 02:11:27</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[build log:

Build started 2010/7/13 10:02:30.
     1&gt;Project "C:UsersCCIEDesktopSilverlightCudaInteropDemoCudaLibCudaLib.vcxproj" on node 2 (build target(s)).
     1&gt;PrepareForBuild:
         Creating directory "C:UsersCCIEDesktopSilverlightCudaInteropDemoDebug".
       InitializeBuildStatus:
         Creating "DebugCudaLib.unsuccessfulbuild" because "AlwaysCreate" was specified.
       CustomBuild:
         Performing Custom Build Tools
         nvcc €=宔X: Unsupported host compiler 'bin'
     1&gt;C:Program FilesMSBuildMicrosoft.Cppv4.0Microsoft.CppCommon.targets(151,5): error MSB6006: "cmd.exe" exited with code -1.
     1&gt;Done Building Project "C:UsersCCIEDesktopSilverlightCudaInteropDemoCudaLibCudaLib.vcxproj" (build target(s)) -- FAILED.

Build FAILED.

Time Elapsed 00:00:02.50]]></wp:comment_content>
			<wp:comment_approved>0</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[176284121]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>35</wp:comment_id>
			<wp:comment_author><![CDATA[jun wei]]></wp:comment_author>
			<wp:comment_author_email>jun.ccie.wei@gmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>58.19.66.74</wp:comment_author_IP>
			<wp:comment_date>2010-07-13 02:12:59</wp:comment_date>
			<wp:comment_date_gmt>2010-07-13 02:12:59</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Build platform:

WIndows 7 + VS 2010 + silverlight 4 + cuda 3.1]]></wp:comment_content>
			<wp:comment_approved>0</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>36</wp:comment_id>
			<wp:comment_author><![CDATA[jun wei]]></wp:comment_author>
			<wp:comment_author_email>jun.ccie.wei@gmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>58.19.66.74</wp:comment_author_IP>
			<wp:comment_date>2010-07-13 02:16:31</wp:comment_date>
			<wp:comment_date_gmt>2010-07-13 02:16:31</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Please post some steps on how to build projects!]]></wp:comment_content>
			<wp:comment_approved>0</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>37</wp:comment_id>
			<wp:comment_author><![CDATA[mr_x]]></wp:comment_author>
			<wp:comment_author_email>113674@gmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>89.76.210.69</wp:comment_author_IP>
			<wp:comment_date>2010-08-15 11:29:47</wp:comment_date>
			<wp:comment_date_gmt>2010-08-15 11:29:47</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Cool article.
You have even inspired our teacher for bsc/bse diploma subject for us, don't do this again :) :)]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>Winter Camping</title>
		<link>http://www.planetmarshall.co.uk/2010/01/winter-camping/</link>
		<pubDate>Thu, 21 Jan 2010 00:53:58 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=513</guid>
		<description></description>
		<content:encoded><![CDATA[[singlepic id=102 w=120 float=left]
<p class="pm_first">Last week myself and a group of friends took a winter camping trip up to the <a title="The Lake District National Park" href="http://www.lakedistrict.gov.uk" target="_blank">Lake District</a>. An odd decision, it could be argued, seen as the region has recently seen both some of its worst flooding and coldest winters in recent years.  Nonethless, equipped with ice axe, crampons and a generous supply of Kendal Mint Cake we set out to climb Scafell.</p>
<!--more-->
<h3 class="pm_first">Some of the things I learned</h3>
<ol>[singlepic id=98 w=120 float=right]
	<li>Elephants, though clearly signposted, are not common in the lake district. I didn't see a single one all weekend. Sheep, however, are plentiful.</li>
	<li>It may be effective as a deterrent against the <a title="Ravenous Bugblatter Beast of Traal" href="http://www.bbc.co.uk/dna/h2g2/A387029" target="_blank">Ravenous Bugblatter Beast of Traal</a>, but a towel is no replacement for an insulating mattress.</li>
	<li>Pop up tents, though useful on the beach, are less effective in torrential rain and gale force winds.</li>
	<li>Retracing your steps back through the snow sounds easy, and it probably is for other people.</li>
	<li>The <a title="The Wasdale Head Inn" href="http://www.wasdaleheadinn.co.uk/home.html">Wasdale Head Inn</a> serves an excellent selection of whiskeys, of which <a title="Wikipedia's entry on Lagavulin." href="http://en.wikipedia.org/wiki/Lagavulin_Single_Malt" target="_blank">Lagavulin </a>is the best. I should know, I tried all of them.</li>
	<li>Swimming in Wastwater in January is almost exactly as cold as you'd expect.</li>
</ol>
<h3 class="pm_first">The Route</h3>
The map below, which requires <a title="Microsoft Silverlight" href="http://www.microsoft.com/SILVERLIGHT/" target="_blank">Microsoft Silverlight</a>, was exported from my <a title="Garmin Forerunner 305" href="https://buy.garmin.com/shop/shop.do?cID=142&amp;pID=349" target="_blank">GPS wristwatch</a> and shows the route we took up Scafell before visibility made further progress a bit risky, and so we retraced our steps back through the snow. Or at least tried to before our steps mysteriously disappeared. There is also a <a title="Photosynth of Scafell" href="http://photosynth.net/view.aspx?cid=4b895bbc-3e41-4957-a35f-b3fab7155bfc" target="_blank">Photosynth </a>from part of our route available.

[silverlight: osmap.xap,520,350,show]
<h3>Swimming in Wastwater</h3>
Although as an amateur triathlete I've done many open water swims, I've never done one in winter and never without a wetsuit. So, in an attempt to kill both birds with one stone I decided to go for a swim in Wastwater in January. I lasted about two minutes. I'm no <a title="Ice Swimmer Lewis Gordon Pugh" href="http://www.lewispugh.com/" target="_blank">Lewis Gordon Pugh</a>. It was cold, but it really wasn't as bad as you might think.  The water was beautifully clear but unfortunately sharp rocks do not a beach make.
<h3>Gallery</h3>
[nggallery id=9] ]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>513</wp:post_id>
		<wp:post_date>2010-01-21 00:53:58</wp:post_date>
		<wp:post_date_gmt>2010-01-21 00:53:58</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>winter-camping</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="bing-maps"><![CDATA[bing maps]]></category>
		<category domain="post_tag" nicename="hiking"><![CDATA[Hiking]]></category>
		<category domain="post_tag" nicename="silverlight"><![CDATA[Silverlight]]></category>
		<category domain="post_tag" nicename="swimming"><![CDATA[Swimming]]></category>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[268619559]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>38</wp:comment_id>
			<wp:comment_author><![CDATA[Gillian Marshall]]></wp:comment_author>
			<wp:comment_author_email>gillian.marshall@travelcounsellors.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>213.106.89.119</wp:comment_author_IP>
			<wp:comment_date>2010-01-21 09:51:13</wp:comment_date>
			<wp:comment_date_gmt>2010-01-21 09:51:13</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Are you SURE you are my son? Question... Picture of Lakes Wildlife - Is that Bigfoot in the background?]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[176284123]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>39</wp:comment_id>
			<wp:comment_author><![CDATA[Aunty Portsmouth]]></wp:comment_author>
			<wp:comment_author_email>edenrose26@ventisei.fsnet.co.uk</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>95.146.64.178</wp:comment_author_IP>
			<wp:comment_date>2010-01-21 19:53:55</wp:comment_date>
			<wp:comment_date_gmt>2010-01-21 19:53:55</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[And I though I was mad trying to drive from Glasgow to Sheffield in the bad weather. But swimming in Wasswater beats everything. you should have kept your vest on!!! Good luck Andrew keep making me proud to be your aunt, and jealous that I am too old and sane to join in.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[176284127]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
	</item>
	<item>
		<title>Drawing geodesic curves using the Bing maps Silverlight control</title>
		<link>http://www.planetmarshall.co.uk/2010/06/drawing-geodesic-curves-using-the-bing-maps-silverlight-control/</link>
		<pubDate>Wed, 30 Jun 2010 14:52:05 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=624</guid>
		<description></description>
		<content:encoded><![CDATA[<p class="pm_first">For an upcoming post I wanted to be able to plot the shortest routes between various positions on the Earth using the <a title="Bing Maps Silverlight Control" href="http://msdn.microsoft.com/en-us/library/ee681884.aspx" target="_blank">Bing Maps Silverlight control</a>. Although since I started working on the problem Bing have provided a similar feature with their <a title="New Bing Map Apps: Gas Prices, Distance Calculator and Parking Finder" href="http://www.bing.com/community/blogs/maps/archive/2010/05/19/new-bing-map-apps-gas-prices-distance-calculator-and-parking-finder.aspx" target="_blank">Distance Calculator App</a>, the functions are not available for reuse via the public API. Interested developers may just want to skip the maths and just download the code.</p>
<a title="Source code in zip file for Silverlight 4.0" href="http://www.planetmarshall.co.uk/code/geodesic.zip">Geodesic source code for Silverlight 4.0</a>
<h2>Geodesics</h2>
[singlepic id=118 float=right w=150]

The shortest path between two points on an arbitrary surface is called a <a title="Geodesic from MathWorld" href="http://mathworld.wolfram.com/Geodesic.html" target="_blank">Geodesic</a>, and on a sphere, it is a <a title="Great Circle from MathWorld" href="http://mathworld.wolfram.com/GreatCircle.html" target="_blank">Great Circle</a>. Modelling the surface of the earth as a perfect sphere, the shortest distance between any two locations on the surface is then described by a section of a Great Circle, ie an arc that lies on the plane that is described by the vectors between its start and end points and the Earth's centre ( see figure 1 ).

With this information, one way ( and the way I have adopted ) to plot such a curve is as follows:
<ol>
	<li>Generate the points of the curve in two dimensions using the parametric equation of a circle.</li>
	<li>Transform the plane of the 2d curve into 3D space such that it intersects the end points on the sphere, and the sphere's centre.</li>
	<li>Project the transformed points back into 2D space using the Mercator projection equations.</li>
</ol>
<!--more-->
[silverlight: Geodesic.xap,520,384,false]
<h2>A Parametric Representation of a Great Circle</h2>
The <a title="Mercator Projection from MathWorld" href="http://mathworld.wolfram.com/MercatorProjection.html">Mercator projection</a> gives the 2D rectilinear coordinates (x,y) as a function of the latitude and longitude of a point on a sphere. However, it is easier to draw the point using a typical drawing API, if we have a representation that gives each point of the curve in terms of a single parameter. To derive such a function, we observe that the parametric equation for a circle is given by

\[
\begin{pmatrix} x \\ y \end{pmatrix} = \begin{pmatrix} r \cos t \\ r \sin t \end{pmatrix}
\]

Since a great circle is a rigid transformation of a circle in 3D space, it can also be represented as a function of a single parameter

\[
\begin{pmatrix} x \\ y \\ z \end{pmatrix} = \mathbf{R}\cdot\begin{pmatrix} r \cos t \\ r \sin t \end{pmatrix}
\]

where \(\mathbf{R}\) is a 2x3 matrix that transforms the plane circle to a location on a sphere. Using <a title="Spherical Coordinates from MathWorld" href="http://mathworld.wolfram.com/SphericalCoordinates.html">spherical coordinates</a>, the Mercator projection of the curve specified above is then
\[
\mathbf{C}(t) =\begin{pmatrix} \lambda \\ \tanh^{-1} \left(\sin \phi \right)\end{pmatrix} = \begin{pmatrix} \tan^{-1}\left(y/x\right)\\ \tanh^{-1}z \end{pmatrix}
\]
Where \(\lambda\) and \(\phi\) are the longitude and latitude of the point to be projected, respectively. Writing the equation out in full gives,

\[
\mathbf{C}(t) = \begin{pmatrix}
\tan^{-1}\left(\frac{R_{2,1}\cos t + R_{2,2}\sin t}{R_{1,1}\cos t + R_{1,2}\sin t}\right)\\
\tanh^{-1}(R_{3,1}\cos t +R_{3,2}\sin t)
\end{pmatrix}
\]

Now that we have a suitable parametric equation, we can draw the geodesic with a series of connected line segments by varying the parameter, t.
<blockquote>Mathematical note - the parameterization given by this expression is highly non-uniform, meaning that there are many more points generated in some parts of the curve than in others. The mathematics of generating uniform ( or natural ) parameterizations belongs to the field of differential curve geometry and is beyond the scope of this article ( and my brain ).</blockquote>
<h2>Implementation notes</h2>
[singlepic id=141 float=left w=150] Inevitably, the mathematics alone is not sufficient to produce an implementation of a reuseable class for the Bing Silverlight control. There are two main issues to resolve; firstly, it is not immediately obvious how to derive from the provided <a title="Documentation on MapShapeBase from MSDN" href="http://msdn.microsoft.com/en-us/library/microsoft.maps.mapcontrol.core.mapshapebase.aspx" target="_blank"><code>MapShapeBase</code></a> class to create new shape overlays and secondly, how to handle drawing the curves when they 'wrap' beyond the map's viewable area ( this is easier to illustrate than to describe - see the figure opposite ).
<h4>Inheriting from <code>MapShapeBase</code></h4>
I must confess that I cheated slightly in implementing the <code>MapGeodesicPath</code> class, in that I used <a title="Reflector from Red-Gate. Stop sending them hate mail!" href="http://www.red-gate.com/products/reflector/" target="_blank">Reflector</a> to peer into the implementation of the base class. The existing derivations of this class simply defer to <code>MapShapeBase</code> for most of the work, which they can do since for a <code>MapPolygon</code> and <code>MapPolyline</code> there is a one-to-one relationship between <code>Locations</code>, latitude and longitude points on the map and <code>Points</code>, the actual 2D cartesian coordinates used to draw the shape. For the Geodesic, this is not the case, because we only want to specify the start and ending points of the curve, not every point in between. A solution is to delegate the point generation code to a secondary class, one that can be independently tested.
<h4>Splitting the curves at the map boundary</h4>
When the curves wrap around the map projection, they need to be split at the boundary. This is done by finding the parameter t for the longitude value of the boundary. Where the longitude value is +/- 180, this is straightforward as the equation above reduces to,
\[
t = -\tan^{-1}\frac{R_{1,2}}{R_{2,2}}
\]
For other longitude values, we simply offset the longitude values by the required amount, and calculate the value of t for the new matrix.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>624</wp:post_id>
		<wp:post_date>2010-06-30 14:52:05</wp:post_date>
		<wp:post_date_gmt>2010-06-30 14:52:05</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>drawing-geodesic-curves-using-the-bing-maps-silverlight-control</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="bing-maps"><![CDATA[bing maps]]></category>
		<category domain="post_tag" nicename="c"><![CDATA[C#]]></category>
		<category domain="category" nicename="mathematics"><![CDATA[Mathematics]]></category>
		<category domain="post_tag" nicename="mathematics"><![CDATA[Mathematics]]></category>
		<category domain="post_tag" nicename="silverlight"><![CDATA[Silverlight]]></category>
		<category domain="category" nicename="software"><![CDATA[Software]]></category>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[268619540]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>42</wp:comment_id>
			<wp:comment_author><![CDATA[vishal]]></wp:comment_author>
			<wp:comment_author_email>vishalishere@msn.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>12.180.151.11</wp:comment_author_IP>
			<wp:comment_date>2010-07-21 18:28:39</wp:comment_date>
			<wp:comment_date_gmt>2010-07-21 18:28:39</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[hi,
this is a great post, it helped me understand how to draw curves on a 2d map and the concept behind it.
will it be possible to draw multi elevation curves and lines 
for example given two sets of data both consists of length (in miles) and a elevation as a number
would it be possible to draw arc that goes upto to certain curve and then rises / drops to the new elevation? like a glider's path.

Vishal]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>43</wp:comment_id>
			<wp:comment_author><![CDATA[Andrew]]></wp:comment_author>
			<wp:comment_author_email>planetmarshalluk@hotmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://www.planetmarshall.co.uk</wp:comment_author_url>
			<wp:comment_author_IP>86.12.139.66</wp:comment_author_IP>
			<wp:comment_date>2010-07-29 09:00:39</wp:comment_date>
			<wp:comment_date_gmt>2010-07-29 09:00:39</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Thanks, Vishal.

Using the Bing API, Location elements can take three parameters : latitude, longitude and elevation, so there's no reason why you can't draw 3D curves. However, you would need a 3D viewer to see the difference.

Andrew.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[176284191]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>44</wp:comment_id>
			<wp:comment_author><![CDATA[vishal]]></wp:comment_author>
			<wp:comment_author_email>vishalishere@msn.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>12.180.151.11</wp:comment_author_IP>
			<wp:comment_date>2010-08-06 17:13:53</wp:comment_date>
			<wp:comment_date_gmt>2010-08-06 17:13:53</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Thanks Andrew,
This is good suggestion. I would do some research on how to use altitude.
your example is great.. and i learnt quite some thanks once again.

Vishal]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[176284193]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>221</wp:comment_id>
			<wp:comment_author><![CDATA[drewnoakes]]></wp:comment_author>
			<wp:comment_author_email>disqus@drewnoakes.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>80.254.147.172</wp:comment_author_IP>
			<wp:comment_date>2011-10-11 08:18:00</wp:comment_date>
			<wp:comment_date_gmt>2011-10-11 08:18:00</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Sounds great, but the download link appears to be broken.  Do you have a backup somewhere?]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[331504051]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>222</wp:comment_id>
			<wp:comment_author><![CDATA[planetmarshall]]></wp:comment_author>
			<wp:comment_author_email>planetmarshalluk@hotmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>194.247.82.76</wp:comment_author_IP>
			<wp:comment_date>2011-10-11 09:10:00</wp:comment_date>
			<wp:comment_date_gmt>2011-10-11 09:10:00</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Hi, thanks for the comment. I'm currently in the process of updating the website and there are a few things I haven't migrated yet. I'll drop you a mail via Disqus when it's ready if you want to have a look, or you can just try again in a couple of days.

Thanks again.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>221</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[331504051]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[331517748]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>224</wp:comment_id>
			<wp:comment_author><![CDATA[drewnoakes]]></wp:comment_author>
			<wp:comment_author_email>disqus@drewnoakes.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>80.254.147.180</wp:comment_author_IP>
			<wp:comment_date>2011-10-24 13:31:00</wp:comment_date>
			<wp:comment_date_gmt>2011-10-24 13:31:00</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Unfortunately I'm still having trouble with the download link.  Any progress?]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>222</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[331517748]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[342571425]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
	</item>
	<item>
		<title>Near Infra Red Pseudocolour using LAB Colour Separations</title>
		<link>http://www.planetmarshall.co.uk/2010/03/near-infra-red-pseudocolour-using-lab-colour-separations/</link>
		<pubDate>Wed, 24 Mar 2010 03:08:55 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=705</guid>
		<description></description>
		<content:encoded><![CDATA[<p>[singlepic id=124 w=120 float=right]</p>
<p class="pm_first">As 2010 is the <a title="BBC article on the history of Infra Red photography" href="http://www.bbc.co.uk/blogs/photoblog/2010/01/on_a_different_wavelength_100_years_of_infrared_ph.html" target="_blank">100th anniversary of the first published infra red photograph</a>, I thought I'd try my hand using my own digital camera and some easily acquired accessories. If you want, you can <a href="http://www.planetmarshall.co.uk/2010/03/near-infra-red-pseudocolour-using-lab-colour-separations/#method">skip</a> the theory and go straight to the description of the method and a script for Photoshop.</p>
<h3>A quick overview of IR photography</h3>
<p>The <a title="Wikipedia's entry on the Charge-Coupled Device" href="http://en.wikipedia.org/wiki/Charge-coupled_device" target="_blank">CCD</a> that is responsible for recording the images photographed by most digital cameras, is already sensitive to the near infra red part of the spectrum. That is, the part of the spectrum outside of the range visible to the human eye, but not so far as that used for, for example, thermal imaging. Since most photographers are not interested in light that they can't see, this light is usually filtered out by an infra red <em>cutoff </em>filter placed inside the camera body, directly in front of the CCD. However, such filters are imperfect, so with some camera models by [singlepic id=120 w=120 float=left] combining a long exposure with an infra red <em>transmitting </em>filter placed in front of the lens, some of that IR light can be recovered. The figure shows the basic principle, though I should add that the graphs are just a sketch to illustrate the principle and don't represent an actual CCD response curve.</p>
<!--more--></p>
<h3>Pseudocolour</h3>
<p>[singlepic id=129 w=120 float=right]Since IR light is invisible, some method is needed to represent it in terms of the colours that we can see. Typically, this is often done by simply mapping the intensities of the IR image to a greyscale, with the result being a black and white photo with a slightly surreal look. For my photographs, however, I wanted to try an alternative method.</p>
<h3>The LAB Colour Model</h3>
<p>[singlepic id=122 w=120 float=left]The most common method of representing a colour image is by a combination of Red, Green and Blue 'colour primaries'. The reason for this is simply because it then becomes relatively trivial to display an image using a video display, which also constructs an image using a combination of red, green and blue LEDs or phosphors. This is why such a model is known as a 'device dependent' model. However, RGB is not the only colour model, and if you are at all familiar with Photoshop you may be aware of the LAB model.</p>
<p>[singlepic id=121 w=120 float=right]LAB, or <a title="Wikipedia's entry on the CIELAB colour space" href="http://en.wikipedia.org/wiki/Lab_color_space" target="_blank">CIELAB </a>to give it its full name, is a device independent model, which like RGB is composed of three components ( or channels ) but in this case only the 'A' and 'B' components contain colour information, whereas the 'L' component contains pure luminosity information. Thus, by separating an image into LAB components it becomes possible to manipulate the luminosity and colour components of an image independently.<br />
<a name="method"></a></p>
<h3>Method and Implementation in Photoshop</h3>
<h4>Equipment</h4>
<ol>
<li>Canon G10 Digital Compact Camera</li>
<li>LA-DC58K lens adapter for same</li>
<li>Hoya R72 58mm Infra Red filter</li>
<li>Tripod</li>
<li>Photoshop ( or GIMP )</li>
</ol>
<p>The images in this post have been created from two source images, one a long exposure taken using the IR filter and the other a conventional colour image. Both images are converted into the LAB colour space, and a single image is then produced, using the Luminosity channel from the IR image and the 'A' and 'B' channels from the colour image. The photoshop script below will automate the process when applied to two source images, you can then manipulate the final image using the adjustment tools. You can also do much the same thing in GIMP using the Decompose/Compose features from the Colour menu, but it does not include Photoshop's image registration or LAB colour adjustment features.</p>
<p>Download <a href="http://www.planetmarshall.co.uk/code/photoshop/ir_composite.jsx.zip">ir_composite.jsx.zip</a></p>
<p>To use the script, open the IR and corresponding colour image, and ensure that the IR image is selected. Then apply the script.</p>
<h3>Practicalities</h3>
<p>There are a number of limitations to multiple exposure photography methods such as this, especially ones which require long exposures and changes of camera equipment. It is best suited to landscape photography in good conditions where the multiple exposures can be easily aligned. If either image contains rapidly moving subjects these can ( and will ) show up as artefacts in the resulting image.</p>
<h3>Gallery</h3>
<p>[nggallery id=12]</p>
]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>705</wp:post_id>
		<wp:post_date>2010-03-24 03:08:55</wp:post_date>
		<wp:post_date_gmt>2010-03-24 03:08:55</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>near-infra-red-pseudocolour-using-lab-colour-separations</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="imaging"><![CDATA[Imaging]]></category>
		<category domain="post_tag" nicename="imaging"><![CDATA[Imaging]]></category>
		<category domain="post_tag" nicename="photography"><![CDATA[Photography]]></category>
		<category domain="category" nicename="software"><![CDATA[Software]]></category>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[271119315]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Visualizing the Prime Ministerial Debates</title>
		<link>http://www.planetmarshall.co.uk/2010/04/visualizing-the-prime-ministerial-debates/</link>
		<pubDate>Thu, 29 Apr 2010 08:30:19 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=805</guid>
		<description></description>
		<content:encoded><![CDATA[<p>[singlepic id=131 w=140 float=right]</p>  <p class="pm_first">For the first time, the main Prime Ministerial candidates for the 2010 UK General Elections, will take part in <a title="Debates page from the BBC" href="http://news.bbc.co.uk/1/hi/uk_politics/election_2010/the_debates/default.stm" target="_blank">three live debates</a>. Since the BBC have kindly made the full transcripts available, I decided to have a go at analyzing the data and creating a <a title="Jump to image gallery" href="#gallery" target="_self">visual representation</a> in the form of word clouds. I am currently working on my own visualization software, but in the meantime these have been done using <a title="Wordle" href="http://www.wordle.net/" target="_blank">Wordle</a>.</p>    <!--more-->    <h3>Preparing the data</h3>  <p>[singlepic id=138 w=140 float=left]The BBC only provides the data in PDF form - to analyze it we need it in text form. Although this is easily done with Acrobat Reader's &quot;Save as Text&quot; function, the output it produces is not really suitable for automatic processing, so some work has to be done by hand. This basically involves making sure each speaker's comments are headed by their name and some kind of special character to split each record ( here I have used '@' ), which took about 15 minutes or so.</p>  <p><a title="First Prime Ministerial debate in raw text form" href="http://bit.ly/9QRrXx" target="_blank">Download </a>the raw text of the first debate.</p>  <p>Having done that, a command line tool such as <a href="http://www.gnu.org/manual/gawk/gawk.html" target="_blank">awk</a> can be used to split the data by speaker. For example, the following command outputs Clegg's comments into a separate file:</p>  
[code lang="bash"]
awk 'BEGIN {RS=&quot;&quot;; FS=&quot;[@]&quot;} $1==&quot;NC&quot; { print $2 }' debate.txt &gt; clegg.txt
[/code]

<h3>Parsing the data</h3>

<p>[singlepic id=137 w=140 float=right]<a title="Python homepage" href="http://www.python.org/" target="_blank">Python</a>'s <a title="The Natural Language Toolkit" href="http://www.nltk.org/" target="_blank">Natural Language Toolkit</a> provides all the functions needed to analyze the text data, such as tokenizing the text by word and even categorizing each word by type, such as proper nouns and prepositions. For example, having extracted Nick Clegg's speech as above and read the file as a string using Python, the following commands parse the input for sentences, and then tokenize each word procucing a complete word list.</p>

[code lang="python"]
from __future__ import division
import nltk, re, pprint

sentences = nltk.sent_tokenize(text)
tokens=[]
for s = sentences:
 tokens.extend(nltk.word_tokenize(s))
words=[t.lower() for t in tokens]
[/code]

<p>We can then categorize each word with a <a title="Wikipdeia page on POS tagging" href="http://en.wikipedia.org/wiki/Part-of-speech_tagging">POS tag</a> and extract a list appropriately, for example, using the word tokens above the following extracts all the nouns</p>

<pre class="brush: py; gutter: false; toolbar: false;"># this operation takes some time to execute
taggedwords=nltk.pos_tag(words)
nouns=[word for (word,tag) in words if t == 'NN']</pre>

<p>Such a list is enough to use with Wordle, however it's straightforward to create a word frequency list for use with other software.</p>

[code lang="python"]
nounfrequencies = nltk.FreqDist(nouns)
[/code]

<h3>Going further</h3>

<p>Word frequency analyses are fairly straightforward, however NLTK is a powerful library and allows for much more detailed and informative analysis based on grammar and sentence structure. It would be interesting to see the results of a more sophisticated approach.
  <br /><a name="gallery"></a></p>

<h3>Gallery of word clouds from the first debate</h3>

<p>[nggallery id=13]</p>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>805</wp:post_id>
		<wp:post_date>2010-04-29 08:30:19</wp:post_date>
		<wp:post_date_gmt>2010-04-29 08:30:19</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>visualizing-the-prime-ministerial-debates</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="imaging"><![CDATA[Imaging]]></category>
		<category domain="post_tag" nicename="imaging"><![CDATA[Imaging]]></category>
		<category domain="post_tag" nicename="politics"><![CDATA[politics]]></category>
		<category domain="post_tag" nicename="python"><![CDATA[python]]></category>
		<category domain="category" nicename="software"><![CDATA[Software]]></category>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[285113393]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>41</wp:comment_id>
			<wp:comment_author><![CDATA[PlanetMarshall &raquo; Blog Archive &raquo; An Illustrated Version of The Rime of the Ancient Mariner, for the Amazon Kindle]]></wp:comment_author>
			<wp:comment_author_email></wp:comment_author_email>
			<wp:comment_author_url>http://www.planetmarshall.co.uk/2010/11/an-illustrated-version-of-the-rime-of-the-ancient-mariner-for-the-amazon-kindle/</wp:comment_author_url>
			<wp:comment_author_IP>208.68.171.100</wp:comment_author_IP>
			<wp:comment_date>2011-06-05 13:59:07</wp:comment_date>
			<wp:comment_date_gmt>2011-06-05 13:59:07</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[[...] using XSLT 2.0 to create the xhtml source for Amazon’s kindlegen tool. As with the Prime Ministerial debates project, the input file needs cleaning up before passing it to an XSLT transformation tool such as [...] ]]></wp:comment_content>
			<wp:comment_approved>trash</wp:comment_approved>
			<wp:comment_type>pingback</wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>An Illustrated Version of The Rime of the Ancient Mariner, for the Amazon Kindle</title>
		<link>http://www.planetmarshall.co.uk/2010/11/an-illustrated-version-of-the-rime-of-the-ancient-mariner-for-the-amazon-kindle/</link>
		<pubDate>Wed, 24 Nov 2010 00:59:59 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=974</guid>
		<description></description>
		<content:encoded><![CDATA[[singlepic id=145 float=right w=150]<p class="pm_first">A few months ago I jumped on the e-reader bandwagon, and purchased the latest version of Amazon’s Kindle device. By and large I’m extremely pleased with it; reading Douglas Adams' Hitchhiker’s Guide to the Galaxy on a device that bears an uncanny resemblance to the eponymous guide itself ( something I’m <a target="_new" href="http://xkcd.com/548/">not the first</a> to notice ), brings me no end of amusement.</p>
<!--more-->
Nonetheless, many of the commercial e-books available via Amazon’s store leave much to be desired in terms of their suitability for reading on the device, largely down to cheap and/or lazy conversions, making some of the more expensive titles a dubious investment. There is, however, a vast library of free, out of copyright content provided by websites like <a href="http://www.gutenberg.org" target="_new">Project Gutenberg</a>. Being free, it would be churlish to complain about matters of style and formatting, particularly when this is easy to rectify with access to the source and a small amount of technical knowledge. For full details on creating content for the Kindle, see the <a href="http://www.amazon.com/gp/feature.html?ie=UTF8&docId=1000234621" target="_new">Amazon Kindle Publishing Program</a>.

Samuel Taylor Coleridge’s <em><a href="http://www.gutenberg.org/ebooks/151" target="_new">Rime of the Ancient Mariner</a></em> is one of many out of copyright texts provided by Project Gutenberg, in both epub and the Kindle’s native mobipocket format, kindly produced by Judy Boss and David Widger. However, as can be seen in the screenshots below from Amazon’s Kindle Previewer program, the formatting could do with some polish. Additionally, it is unillustrated, which is a shame because <a href="http://en.wikipedia.org/wiki/Gustave_Dor%C3%A9" target="_new">Gustav Dor&eacute;’s</a> wonderful artwork is also available in the public domain, at least in the resolution required for an ebook, from <a href="http://dore.artpassions.net/" target="_new">http://dore.artpassions.net/</a>.

[singlepic id=142 float=left w=150]

Using the plain html file as a starting point, converting it directly results in a file that looks much like the mobi file on Project Gutenberg. However, with access to the source, we can do a bit better.
<h3>Formatting the text for Kindle</h3>
I’m using <a href="http://en.wikipedia.org/wiki/XSLT" target="_new">XSLT</a> 2.0 to create the xhtml source for Amazon’s kindlegen tool. As with the <a target="_new" href="http://www.planetmarshall.co.uk/2010/04/visualizing-the-prime-ministerial-debates/">Prime Ministerial debates project</a>, the input file needs cleaning up before passing it to an XSLT transformation tool such as <a href="http://saxon.sourceforge.net/" target="_new">Saxon</a>.

Following the suggestions here : <a target="_new" href="http://www.xmlplease.com/xhtmlxhtml">http://www.xmlplease.com/xhtmlxhtml</a>, I made the following changes to the input document to prepare it for processing
<ol>
	<li>Added xml header</li>
	<li>Removed HTML DTD. If you don’t do this, most XSLT processors will try to resolve the DTD over the network and take forever as a result.</li>
	<li>Added ENTITY declarations for any named HTML character entities used in the source, such as '&amp;mdash;'</li>
	<li>Removed any invalid xhtml such as orphaned &lt;br&gt; and &lt;hr&gt; tags.</li>
</ol>
Having done that, the document should parse. The snippet below uses XSLT 2.0's regular expression support to add line breaks to the text, and wrap each verse in paragraph blocks. 

[code lang="xml"]
&lt;xsl:template match=&quot;xhtml:pre&quot;&gt;
 &lt;div&gt;
 &lt;xsl:for-each select=&quot;tokenize(string(.),'nn')&quot;&gt;
  &lt;p&gt;&lt;xsl:text&gt;&amp;#10;&lt;/xsl:text&gt;
  &lt;xsl:analyze-string select=&quot;.&quot; regex=&quot;n&quot;&gt;
   &lt;xsl:matching-substring&gt;
    &lt;!-- add newlines to keep the source tidy --&gt;
    &lt;br/&gt;&lt;xsl:text&gt;&amp;#10;&lt;/xsl:text&gt;
   &lt;/xsl:matching-substring&gt;
   &lt;xsl:non-matching-substring&gt;
    &lt;xsl:value-of select=&quot;.&quot;/&gt;
   &lt;/xsl:non-matching-substring&gt;
  &lt;/xsl:analyze-string&gt;
  &lt;xsl:text&gt;&amp;#10;&lt;/xsl:text&gt;&lt;/p&gt;
 &lt;/xsl:for-each&gt;
 &lt;/div&gt;
&lt;/xsl:template&gt; 
[/code]

After adding a stylesheet to centre text and add appropriate paragraph spacing, here is the result.

[singlepic id=144 float=left w=150]

<h3>Licensing and distribution</h3>
I have chosen to license the completed ebook under a Creative Commons <a href="http://creativecommons.org/licenses/by-sa/3.0/" target="_new">share-and-share-alike license</a>, although this does not affect the public domain status of Coleridge's text or Dor&eacute;'s illustrations. The compiled book is available for download from the <a href="http://openlibrary.org/books/OL24489895M/Rime_of_the_ancient_mariner" target="_new">Open Library</a> or directly from the <a href="http://www.archive.org/details/TheRimeOfTheAncientMarinerillustrated" target="_new">Internet Archive</a>. You can also <a href="http://www.planetmarshall.co.uk/files/mariner.zip">download the source</a>, excluding the images.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>974</wp:post_id>
		<wp:post_date>2010-11-24 00:59:59</wp:post_date>
		<wp:post_date_gmt>2010-11-24 00:59:59</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>an-illustrated-version-of-the-rime-of-the-ancient-mariner-for-the-amazon-kindle</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="kindle"><![CDATA[Kindle]]></category>
		<category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_wp_old_slug</wp:meta_key>
			<wp:meta_value><![CDATA[]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[283423794]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Adventures in Knoydart</title>
		<link>http://www.planetmarshall.co.uk/2011/09/adventures-in-knoydart/</link>
		<pubDate>Mon, 05 Sep 2011 09:20:57 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://97.107.139.84/?p=1042</guid>
		<description></description>
		<content:encoded><![CDATA[[map width="400px" height="400px" center="56.98004613004016,-5.507129192249924" zoom="10" gpx="knoydart.gpx" float="right" image=knoydart.png ]
<p class="pm_first">
Despite having been born and brought up for the first half of my life in Scotland, and having recently returned there, I have seen and explored little of it. Until recently I believed Fort William to be in the reasonably far north, despite the fact that the most cursory glance of a map reveals it to be only about halfway between Carlisle and Thurso. As part of what I hope will be a series of adventures to explore the rest of the land of my birth, I decided to venture into Knoydart, the region between Lochs Nevis and Hourn, at least partly inspired by the initial stages of the <a href="http://en.wikipedia.org/wiki/Cape_Wrath_Trail" title="The Cape Wrath Trail (Wikipedia)" target="_blank">Cape Wrath Trail</a>. The aim would be to reach Inverie, and its pub <a href="http://www.theoldforge.co.uk/" title="The Old Forge" target="_blank"><em>The Old Forge</em></a>, the most remote pub in mainland Britain. Also, being of modest mountaineering ambitions, I would try to prefer high level routes where possible.</p>
<!--more-->
<h2>Day 1 : Glenfinnan to Strathan</h2>
<p>I don't drive, and so am subject to the vagaries of public transport, which in the less densely populated areas of Scotland are more vague than most. I was however able to arrive at Fort William station at a reasonable hour, making the obligatory stop at Nevisport to pick up anything I'd forgotten, including a hat, but not insect repellent, something I was to regret several times over the course of the next few days. </p>
<p> 
[singlepic id=151 w=100 float=left]Rather than start my journey from Fort William, I opted to get the train to Glenfinnan and start from there. I had last been in my childhood or early teens and had taken a photograph of the monument during some appalling weather, which has since become an oil painting and present for some recently married friends. I couldn't resist the opportunity to make a quick stop to take another picture of what is probably one of the most beautiful places in Scotland.</p>
<p>[singlepic id=153 w=100 float=right]Here my journey began in earnest, walking from the monument under the famous Glenfinnan Viaduct. Since its appearance in the Harry Potter films, this location has brought in tourists from far and wide, these were the last people I was to see for some time, however at the time of writing there was a lot of work going on as part of a hydroelectric project and so I didn't really begin to feel the isolation I'd been anticipating until I was well past the Glenfinnan Lodge. Here a track diverges to go up over Sgùrr nan Coireachan ( marked with a red dotted line on the map ), which I would have taken had circumstances permitted. I did consider the detour, but it was late ( about 3pm ), and the weather was less than ideal so I opted for the low level route. A little later the skies opened, and I knew that I had made the right decision.</p>

[singlepic id=147 w=100 float=left]Once out of Gleann Cuìrnean,  the route crosses over the river Pean and <a href="http://www.amazon.co.uk/North-Cape-William-Wrath-Cicerone/dp/1852842857/ref=sr_1_1?ie=UTF8&qid=1315185066&sr=8-1" title="North to the Cape ( Amazon UK )" target="_blank">Brook and Hinchliffe's guide</a> suggests avoiding the conifer forest and making your way around the edge toward Strathan. However, I found the ground here to be extremely boggy and eventually, in order to make further progress, I had to succumb to getting my feet wet and wade through about 2 feet of marsh water. To anyone attempting this route, I recommend fighting through the conifers to find the track through the forest, or perhaps going along the riverbank where the ground may be firmer.

It was by this point getting dark, and I was tired, so I decided to camp on the first bit of acceptable ground rather than continue on toward Glendassary. Unfortunately I discovered that I had neglected to bring anything with which to light my stove, and so a well needed brew was not an option. In addition, the considerable weight of the stove was now largely redundant and not for the first time I thought about how in future I might save some weight.

<h2>Day 2 : Strathan to Sourlies</h2>

[singlepic id=152 w=100 float=left]I woke to find that the predicted foul weather had not yet arrived, and resolved to make an early start. I was packed up and ready to go by 8.00 am, and despite lacking a hot breakfast I was feeling pretty good and made good time along the solid track through Glendassary. I noticed that some fellow wild campers had made good use of the fact that the ground here was much nicer than at Strathan, the first people I'd seen since Glenfinnan. I made a mental note to camp here if I came this way again.

[singlepic id=162 w=100 float=right]At this point I had to make the first real decision affecting my route, it was early enough that I could opt to traverse the Glendassary ridge all the way to Sourlies, however I was suspicious of the weather, both the <a href="http://www.metoffice.gov.uk/loutdoor/mountainsafety/westhighland/westhighland_latest_weather.html" title="MET office mountain forecast for the West Highlands" target="_blank">MET</a> office and <a href="http://www.mwis.org.uk/nw.php" title="Mountain Weather Information Service for the Northwest Highlands" target="_blank">MWIS</a> had forecast rain and high winds on the summits, and so I opted for the valley rather than the ridge. It was a decision I still regret, but at the time it was the sensible one.

[singlepic id=154 w=100 float=left]As the day went on, the rain and winds failed to materialize. In fact the weather was glorious, and the dreaded midgies took maximum advantage of the still weather and my bare arms. By about 11.00am I made the decision to try to get up onto the ridge and make the most of the conditions while they held. The OS 50,000 map indicates a path from the valley up to the ridge but I failed to find it, and instead improvised my way along sheep tracks and up gullies. While letting my mind wander it occurred to me that Sheep Track Optimization could be an unexplored avenue for heuristic optimization techniques, but I digress ( see <a href="http://en.wikipedia.org/wiki/Ant_colony_optimization_algorithms" title="Ant Colony Optimization ( Wikipedia )" target="_blank">Ant Colony Optimization</a> in case you think I've gone barking mad ). Eventually I found the crest of the ridge, where there was a clearly well trodden path and a wall, over which was a dramatic view toward Loch Quoich.

[singlepic id=165 w=100 float=right]It was a glorious day for walking the ridge, with a good path and plenty of opportunities for easy and totally unnecessary scrambling. The huge peaks of Garbh Chioch Mhòr and Sgùrr Na Cìche ( which rather amusingly translate as 'Big Rough Place of the Breast' and 'Peak of the Breast' respectively ) command awesome views of Knoydart and beyond. 

[singlepic id=156 w=100 float=left]Descending the ridge from Sgùrr Na Cìche it gradually became obvious that the gusts of wind were increasing in strength and in frequency, and that the long heralded foul weather had been merely delayed. The path had long since disappeared to give way to some fairly nondescript peatbogs, and it became clear I was not going to get off the ridge before nightfall. There was a lochan at about 400m that would have been an idyllic spot but for the fact it offered no shelter from the, by now, impressive wind blowing from the direction that I had come. I found a reasonably sheltered spot on the south side of the ridge, set up the tent and perched on a rock  to watch the sun set. 

<h2>Day 3 : Sourlies to Inverie</h2>

The weather arrived sometime during the night. The tent however performed admirably, staying rock solid in the face of every blast of gale force wind and every torrent of rain. Lighter tents are available, but for once I was glad to carry a bit of extra weight for something solidly constructed ( The tent is a <a href="http://hilleberg.se/product/akto" title="Hilleberg Akto" target="_blank">Hilleberg Akto</a> for those interested ). I remember listening to the noise of rain and wind and wishing I could get to sleep, only to drift off and the next thing I knew it was morning.

[singlepic id=166 w=100 float=right]I woke to find that the trickle of water I had heard from a nearby stream now sounded like a full blown waterfall, though thankfully it was nowhere near the tent. It was a miserable morning, and I took my time about packing up. The rain was easing off, but I nonetheless decided to get off the ridge as quickly as possible rather than take the longer route toward the beach at Loch Nevis. Visibility gradually improved, but the going was difficult and it was the best part of an hour before I made the footbridge.

[singlepic id=159 w=100 float=left]Here I was somewhat surprised to meet a couple of walkers who had spent the night at Sourlies Bothy ( 'Luxury', apparently, though they wouldn't have had my views ). They had already crossed the bridge, conveniently demonstrating that it wasn't quite the death trap it looked. Actually it was pretty solid, though it swings disconcertingly if you try to cross at speed. From here a good stalkers path climbs to the bealach at the head of Gleann Meadail.

[singlepic id=163 w=100 float=right]By this time I could practically taste the beer at The Old Forge, and struck up a pace that would make a mockery of Naismith's rule. I noted on the map that I could have taken another high level diversion here over Meall Buidhe, but again I was thwarted by the weather. As I approached Inverie, signs of civillization began to appear: the odd outbuilding, landrover tracks, highland cattle. I made it to Inverie by 4pm, and went straight to the pub where I met a walker who had come south over Ladhar Bheinn, immediately making me feel like a wimp.

<h2>Inverie, and home.</h2>

There is a perfectly good campsite at Inverie, and a bunkhouse, but I felt that I'd earned a small amount of luxury and decided to try my luck at the B&B, <a href="http://www.knoydartlodge.co.uk/" title="Knoydart Lodge" target="_blank">Knoydart Lodge</a>. I popped my head round and managed to disturb  the owners, Bob and Morag, and their guests having dinner. Luckily there was a room available. 

[singlepic id=160 w=100 float=left]Knoydart Lodge puts many of the hotels I have stayed in to shame, the bedroom had a huge double bed and breakfast the following morning was fresh and cooked to order. That evening I had dinner at the pub and returned to Knoydart Lodge to while away the evening chatting to Bob, Morag and their guests, who had brought guitars, a mandolin and an accordion to have 'a wee tune'. My version ( actually Travis' version ) of the Britney Spears hit '<em>Hit me baby one more time</em>' caused some hilarity but was, sadly, not really up to scratch. I was able to redeem myself with a few bars of Rachmaninoff on the piano until I reached a mental block probably caused by too much whisky.

The following morning, while well rested, I decided to expedite my route home by taking the local ferry to Mallaig, and thence the train back to Edinburgh via Fort William. Unfortunately there was a considerable gap between connections at Fort William and so I was forced to spend a few hours in <em><a href="http://www.grogandgruel.co.uk/" title="The Grog and Gruel, Fort William" target="_blank">The Grog and Gruel</a></em>. Life is hard, sometimes.

[nggallery id=15]]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1042</wp:post_id>
		<wp:post_date>2011-09-05 09:20:57</wp:post_date>
		<wp:post_date_gmt>2011-09-05 09:20:57</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>adventures-in-knoydart</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="hiking"><![CDATA[Hiking]]></category>
		<category domain="category" nicename="sport"><![CDATA[Sport]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[405109934]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>217</wp:comment_id>
			<wp:comment_author><![CDATA[Graham]]></wp:comment_author>
			<wp:comment_author_email>gs300@cantab.net</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>86.30.200.82</wp:comment_author_IP>
			<wp:comment_date>2011-09-11 21:14:00</wp:comment_date>
			<wp:comment_date_gmt>2011-09-11 21:14:00</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Will have to go back one day - looks like you had a great time!
http://grahamsmunros.blogspot.com/2006_12_01_archive.html

...have a look at 9-13! ]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[307352947]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>218</wp:comment_id>
			<wp:comment_author><![CDATA[planetmarshall]]></wp:comment_author>
			<wp:comment_author_email>planetmarshalluk@hotmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>194.247.82.76</wp:comment_author_IP>
			<wp:comment_date>2011-09-12 13:27:00</wp:comment_date>
			<wp:comment_date_gmt>2011-09-12 13:27:00</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Cheers]]></wp:comment_content>
			<wp:comment_approved>0</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>217</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[307352947]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[307804765]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>219</wp:comment_id>
			<wp:comment_author><![CDATA[planetmarshall]]></wp:comment_author>
			<wp:comment_author_email>planetmarshalluk@hotmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>194.247.82.76</wp:comment_author_IP>
			<wp:comment_date>2011-09-12 13:32:00</wp:comment_date>
			<wp:comment_date_gmt>2011-09-12 13:32:00</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Cheers, Graham. Looks like I'm trailing you by about 100 or so, though I don't see any of the Mamores on your list. Currently considering them for a winter trip, maybe early December.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>217</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[307352947]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[307808299]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
	</item>
	<item>
		<title>Solving Listener Crossword 4151 with Mathematica</title>
		<link>http://www.planetmarshall.co.uk/2011/10/solving-listener-crossword-4151-with-mathematica/</link>
		<pubDate>Wed, 12 Oct 2011 09:29:25 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1126</guid>
		<description></description>
		<content:encoded><![CDATA[[singlepic id=181 float=right w=150]<p class="pm_first"><a href="http://mathsjam.com/" target="_blank" title="MathsJam">MathsJam </a>is a monthly meeting for people interested in recreational mathematics, and drinking of beer. At the <a href="http://mathsjam.com/index.php?content=edinburgh" title="MathsJam Edinburgh" target="_blank">Edinburgh meeting</a> in August, we were presented with this <a href="http://www.listenercrossword.com/" title="The Listener Crossword" target="_blank">Listener Crossword</a>, from <a href="https://www.crosswordclub.co.uk/" title="The Times Crossword Club" target="_blank">The Times Crossword Club</a>. At the time of writing, there are plenty of solutions on the web from those who tackled the puzzle in the traditional manner of brain, pen and paper. I opted to cheat. 
<!--more-->
The description of the puzzle itself is quite complex, but in a nutshell the task is to substitute each of the given letters for one of the first ten prime numbers ( with no duplication ). The expression for each clue will then give a numerical solution. Substitute each digit in the solution with the first letter of its name and write the result in the crossword. There are two ways of substituting digits for letters, either in English or in German, but a solution to a given clue must be consistently one language or the other.

<h2>An Algorithmic Solution</h2>

I have decided to use <a href="http://www.wolfram.com/mathematica/" title="Wolfram Mathematica" target="_blank">Mathematica</a> due to its built in symbolic evaluation capabilities, but in principle any sufficiently powerful programming language would do. If you wish you can <a href="#Download">download</a> a copy of the mathematica notebook.

The goal of the algorithm will be to find two sets of rules that map the first 10 primes to the given letters, which give valid solutions. One straightforward way to achieve this is to enumerate every single possibility until we find two such sets. So how many possibilities are there?

There are \(10! = 3,628,800\) possible sets of rules to examine. However, for each of the 27 clues, the solution generated by each rule set can be one of two options: English or German. That means that the total number of candidate solutions is
\[
10!\times 2^{27}=487,049,291,366,400
\]

This is what's called the 'solution space', and at a rate of 1000 candidates per second, it would take over 15,000 years to examine them all. Clearly this kind of brute force enumeration is impractical.

However, most of these solutions will be invalid in some way. In fact, if we trust the crossword compilers, all but two of them will be invalid. Some rules will produce solutions of the wrong size, others may conflict with other solutions in the crossword, and some may be invalid from a mathematical point of view ( such as a division that does not produce a whole number ). If instead of trying to solve the puzzle in one go, we construct 'partial' solutions in some systematic fashion, we could avoid exploring parts of the solution space that cannot possibly lead to a correct solution. This is the principle behind the <a href="http://en.wikipedia.org/wiki/Backtracking" title="Wikipedia article on Backtracking" target="_blank">backtracking search</a>, one of the cornerstones of artificial intelligence. 

<h2>Implementation of a Backtracking Search</h2>

The notion of a partial solution comes quite easily when considering a crossword puzzle, as it is simply a puzzle that is incomplete - ie, the solutions to at least one clue has been filled in. As an example, consider clue 19 Down : \(A^2\).

There are ten ways of mapping the single letter in 19 down to each prime

[mathematica]
In[1]  := rules = {{a -&gt; 2}, {a -&gt; 3}, {a -&gt; 5}, {a -&gt; 7}, {a -&gt; 11}, {a -&gt; 13}, {a -&gt; 
   17}, {a -&gt; 19}, {a -&gt; 23}, {a -&gt; 29}}

In[2]  := a^2/.rules
Out[2] = {4, 9, 25, 49, 121, 169, 289, 361, 529, 841}
[/mathematica]

Since we know 19 Down must be three letters long, immediately we can discard the first four candidates. The remainder are all possibilities, since at this point we have no more information. Lets take the first matching possibility, \(A^2=121\) given by the rule \(A=11\).

In English, this gives

[mathematica]
In[3]  := IntegerDigits[121] /. {1 -&gt; &quot;O&quot;, 2 -&gt; &quot;T&quot;}
Out[3] = {&quot;O&quot;, &quot;T&quot;, &quot;O&quot;}
[/mathematica]

If we now look at 21 Across - \(ABI\) - There are 2 symbols to map to the remaining 9 primes ( "A" has already been mapped to 11 by 19 Down ). The number of <em>ordered</em> k-subsets of n is given by, 
\[
_nP^k = \frac{n!}{(n-k)!}
\]

So we have \(9!/7!=90\) new sets of rules to examine
[mathematica]
In[4] := rules = {a -&gt; 11, b -&gt; #[[1]], i -&gt; #[[2]]} &amp; /@ 
 Permutations[{2, 3, 5, 7, 13, 17, 19, 23, 29}, {2}] 
Out[4] = {{a -&gt; 11, b -&gt; 2, i -&gt; 3}, {a -&gt; 11, b -&gt; 2, i -&gt; 5},...

In[5] := a b i/. rules
Out[5] = {66, 110, 154, 286, 374, 418, 506, 638, 66,...
[/mathematica]

Again, many of the partial solutions produced by these rules are invalid. Only 36 are the required 4 digits long, and we also now have information about the form of this solution. We know that the first letter is "T", given to us by the puzzle setter, and also that the last letter is "T", because of our solution to 19 Down : "OTO".

[mathematica]
In[6] := candidates = Select[a b i /. rules, Length[IntegerDigits[#]] == 4 &amp;]
Out[6] = {1045, 1265, 1595, 1001, 1309, 1463, 1771, 2233,...

In[7] := englishRules = {0 -&gt; &quot;Z&quot;, 1 -&gt; &quot;O&quot;, 2 -&gt; &quot;T&quot;, 3 -&gt; &quot;T&quot;,...
In[8] := germanRules = {0 -&gt; &quot;N&quot;, 1 -&gt; &quot;E&quot;, 2 -&gt; &quot;Z&quot;, 3 -&gt; &quot;D&quot;,...
In[9] := candidates = StringJoin @@@ ((IntegerDigits /@ candidates)
   /. Join[english, german])
Out[9] = {&quot;OZFF&quot;, &quot;OTSF&quot;, &quot;OFNF&quot;, &quot;OZZO&quot;, &quot;OTZN&quot;, &quot;OFST&quot;,...

In[10] := Select[candidates, StringMatchQ[#, RegularExpression[&quot;T..T&quot;]] &amp;]
Out[10] = {&quot;TTTT&quot;, &quot;TFFT&quot;, &quot;TTTT&quot;, &quot;TFFT&quot;}
[/mathematica]

Note the duplicates. This is because \(B I = I B \), but we cannot eliminate them because the rules used to produce them are different, and so will lead to different partial solutions. By applying the constraints systematically, we have reduced the number of potential solutions for 21 Across from 90 to just 4.

[singlepic id=178 float=left w=256]We then repeat this process in a recursive manner, using one of the valid solutions to 21 across, and the rules that  were used to generate it, to examine the next clue. We continue in this fashion until either the crossword is filled, or we reach a dead end ( which is more likely ). If we reach a dead end, we backtrack ( hence the name ) to one of the possibilities we haven't tried yet. 

Why is this approach any more efficient than the brute force enumeration described above? The key is the generation of partial solutions in a tree like fashion, and the ability to eliminate them when we know that they could not possibly form part of a full solution. When we eliminate such a partial solution because it didn't satisfy the constraints, we eliminate all the possible solutions leading from that branch. For example, when we eliminated the rule \(A=2\) because it produced a solution to 19 Down that was too short, it eliminates not just one solution but all \( 9!\times 2^{27}=48,704,929,136,640 \) solutions incorporating that rule. Not bad for a single calculation.

<h2>The Solution</h2>
In abbreviated form, the algorithm looks something like this.

[mathematica]
ExamineNextCandidate[{solved_, unsolved_}, 
  rules_] := {solved, rules} /; Length[unsolved] == 0

ExamineNextCandidate[{solved_, unsolved_}, rules_] := Module[{...},
   {clueIdx, cluePattern} = First[unsolved];
  nextRuleSet = 
   GenerateRules[GetSymbolsInClue[ClueExpression[clueIdx]], rules];
  solution = Null;
  While[Length[nextRuleSet] &gt; 0 &amp;&amp; solution == Null,
   nextRule = First[nextRuleSet];
   nextRuleSet = Rest[nextRuleSet];
   candidates = 
    StringJoin @@@ (IntegerDigits[
        ClueExpression[clueIdx] /. nextRule] /. {english, german});
   candidates = FilterCandidatesByConstraints[candidates];
   If[Length[candidates] &gt; 0,
     nextPatterns = 
      GenerateNewPatterns[unsolved, {#, clueIdx}] &amp; /@ candidates;
     nextArgs = {Append[solved, First[#]], Rest[#]} &amp; /@ nextPatterns;
     While[solution == Null &amp;&amp; Length[nextArgs] &gt; 0,
      solution = ExamineNextCandidate[First[nextArgs], nextRule];
      nextArgs = Rest[nextArgs]
      ];
     ]
    ];
  solution
[/mathematica]
 
Note that the function <code>ExamineNextCandidate</code> calls itself until the pattern on the list of unsolved solutions is met, ie the list is empty. We call this function using an initially empty rules list, and the patterns provided by the puzzle setter.

[mathematica]
In[1]:=ExamineNextCandidate[{{}, {...,{20, &quot;..&quot;}, {21, &quot;T...&quot;}, {23, &quot;....&quot;},...}, {}]
Out[1]={...,{20, &quot;FE&quot;}, {21, &quot;TTTT&quot;}, {23, &quot;FZFO&quot;},...}
[/mathematica]

[singlepic id=179 w=256 float=left] On my dual core netbook ( A 2010 Alienware M11xR2 ), this took just over 2 seconds to find a solution.

For the second puzzle, we alter the pattern to specify that the first letter of 21 Across ( and last of 9 Down ) can be any letter <em>except</em> 'T', using the regular expression <code>"[^T]..."</code>. In the code snippets, I have abbreviated the output somewhat. See the attached Mathematica notebook file for full details.

[mathematica]
In[2]:=ExamineNextCandidate[{{}, {...,{20, &quot;..&quot;}, {21, &quot;[^T]...&quot;}, {23, &quot;....&quot;},...}, {}]
Out[2]={...,{20, &quot;EE&quot;}, {21, &quot;FFTT&quot;}, {23, &quot;FZFO&quot;},...}
[/mathematica]

[singlepic id=180 w=256 float=right] Finally, the last part of the puzzle is to complete the following task:

<blockquote>"Solvers must identify the English transcriptions of the answers entered using German in one of the grids, which, in clue order, form two words of equal length that are to be entered below the grids, one on each side of the colon; this will relate to a claim made above."
</blockquote>

To identify the answers entered in German, we apply the rules returned by the solver to the original expressions and use the German digit replacement rules. We then compare these to the completed grid.

[mathematica]
In[1]:={solution,rules}=ExamineNextCandidate[{{}, {...,{20, &quot;..&quot;}, {21, &quot;T...&quot;}, {23, &quot;....&quot;},...}, {}]
Out[1]={...,{a -&gt; 11, b -&gt; 17, d -&gt; 19, e -&gt; 7,...}}

In[2]:=Intersection[(clues /. rules1) /. {a_, b_} :&gt; {a, 
    IntegerDigits[b] /. german}, solution][[;;,1]]
Out[2]={10, 11, 13, 16, 25, 29, 30}

In[3]:=(Select[clues, MemberQ[%2, First[#]] &amp;] /. rules) /. {a_, b_} :&gt; {a,
    StringJoin @@ (IntegerDigits[b] /. english)}
Out[3]={{10, &quot;SF&quot;}, {11, &quot;NF&quot;}, {13, &quot;FOO&quot;}, {16, &quot;TNOTE&quot;}, {25, &quot;NON&quot;}, {29,
   &quot;SENSE&quot;}, {30, &quot;SSF&quot;}}
[/mathematica]

Having identified those clues, we reevaluate the expressions this time using the English rules. There are 4 clues that are the same in both German and English, but it is pretty clear that the required words are "<strong>Footnote</strong>" and "<strong>Nonsense</strong>"
<h2>Download</h2>
<a name="Download"/><a href="http://www.planetmarshall.co.uk/code/xword/xword.nb" title="Mathematica Notebook" target="_blank">Mathematica Notebook (111K)</a>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1126</wp:post_id>
		<wp:post_date>2011-10-12 09:29:25</wp:post_date>
		<wp:post_date_gmt>2011-10-12 09:29:25</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>solving-listener-crossword-4151-with-mathematica</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="artificial-intelligence"><![CDATA[Artificial Intelligence]]></category>
		<category domain="post_tag" nicename="mathematica"><![CDATA[Mathematica]]></category>
		<category domain="category" nicename="mathematics"><![CDATA[Mathematics]]></category>
		<category domain="post_tag" nicename="mathematics"><![CDATA[Mathematics]]></category>
		<category domain="category" nicename="software"><![CDATA[Software]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Vancouver</title>
		<link>http://www.planetmarshall.co.uk/2011/10/vancouver/</link>
		<pubDate>Sat, 01 Oct 2011 18:36:38 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1147</guid>
		<description></description>
		<content:encoded><![CDATA[<p class="pm_first">One of the advantages of my job is the ocassional opportunity to visit Vancouver. This is the first time I’d visited the city ( or Canada, in fact, though I have been to the US a few times ) and I wanted to make the most of the free time I had.</p> 

[map center=49.40815,-123.21105 gpx=vancouver.gpx mode=aerial tile=vancouver zoom=11 image=vancouver.png]
Having decided do go for a hike in the surrounding mountains, I only really had one full day free, limiting my options to what was easily accessible and returnable from in a day. Some of my colleagues had previously been to Grouse Mountain and mentioned it as a possible destination, but having never been higher than Ben Nevis ( at 1344m, 4409 ft, the highest mountain in the UK ) I wanted to use this opportunity to improve on that. Further to the west than Grouse, <a href="http://www.env.gov.bc.ca/bcparks/explore/parkpgs/cypress/" title="Cypress Provincial Park" target="_blank">Cypress Provincial Park</a> offers a number of peaks starting at around 1350m and steadily increasing in height as you go further north. These peaks form part of the popular <a href="http://www.env.gov.bc.ca/bcparks/explore/parkpgs/cypress" target="_blank">Howe Sound Crest Trail</a>, the full length of which is around 30km but I would only be doing the portion as far as <a href="http://en.wikipedia.org/wiki/The_Lions_(peaks)" title="The Lions ( Wikipedia )" target="_blank">The Lions</a> - two 1600m peaks visible from Vancouver that are not entirely dissimilar from Garbh Chioch Mhòr and Sgùrr Na Cìche in <a href="http://www.planetmarshall.co.uk/2011/09/adventures-in-knoydart/" title="Adventures in Knoydart" target="_blank">Knoydart</a>. From what I can ascertain, ascending The Lions themselves requires scrambling ( class 4 according to Wikipedia, though I have no idea what that is in UK terms ), however strange peaks in strange countries merit appropriate safety gear, so this time at least I would content myself to the summit of Unnecessary Mountain, which at 1530m fulfilled my &quot;higher than Nevis&quot; criterion well enough. </p>  
<!--more-->
<h2>Cypress Mountain to Lions Bay</h2>

[singlepic float=left id=172 w=150]<p>I dislike retracing my steps, so I prefer circular routes where possible, or failing that a destination served by public transport back to my starting point. With that in mind I perused the useful <a href="http://www.vancouvertrails.com/" title="Vancouver Trails" target="_blank">Vancouver Trails</a> website for a suitable route. I opted for a portion of the Howe Sound Crest Trail, taking me over St Mark's Summit and Unnecessary Mountain to The Lions, and then a sharp descent to Lions Bay from where a regular bus service goes back to Vancouver. </p>  <p>Vancouver Trails rates its routes as Easy/Intermediate/Difficult, but this means little if you have no basis for comparison. The portion as far as St Mark's Summit ( intermediate ) is virtually a gravel track for most of the way, with a few sections of clambering over fallen trees near the top. Compared to hiking in the UK it’s a luxurious highway. Between St Mark's Summit and Mount Unnecessary a sign indicates that the improvements that have been done to the trail by the local authorities come to an end, after which the ground is rough and going is hard and a map is all but useless - but there are orange tags and other such markers hanging from branches, nailed to trees and sprayed on rocks for the entire route making it difficult to miss. </p> <p> [singlepic float=right id=173 w=150]The portion on the ridge itself is the most rewarding, with its spectacular views. At this time ( late September ) there was a little snow but most of it avoidable, and even where not avoidable it wasn't anything that would necessitate crampons, the worst consequences of a slip being embarrassment and a wet arse. There are some fixed ropes left in some areas to ease clambering off the rocks but personally I prefer not to trust my wellbeing to ropes when I have no idea who put them there. In any case they aren't really necessary to progress.</p>  <p>[singlepic float=left id=177 w=150]The ascent and descent from Lions Bay is described as 'difficult' by Vancouver Trails, and though I would only be doing the descent it's a bit of a slog and I would say that although being both longer and higher than Ben Nevis via the Pony Trail, it's a route of similar character. The last section however, where the track widens and zig-zags down the hill is tedious beyond belief, and what I wouldn't have given for a mountain bike at that stage.</p>  <p>One major difference between hiking in Scotland and Canada is the presence of bears. Hikers are advised to carry various forms of protection as an emergency measure, such as a pepper spray variant available from outdoor shops in the area. Bears, I am told, tend to avoid the smell and noise of people anyway, which I imagine is true since I didn’t see a single one. I did buy the pepper spray, however, though I was unable to take it on the plane back to the UK.</p>  <h2>The interactive map</h2>  <p>A quick word on the interactive map above for those interested ( if you're viewing this as a Facebook note or RSS feed, you'll need to view the original post to see it ). The basic service is provided by Microsoft, the reason I don't use Google Maps is that Microsoft provide access to the UK's Ordnance Survey topographical mapping. I have customised it somewhat for this specific post, using the Canadian Government's <a title="Geogratis" href="http://geogratis.gc.ca/geogratis/en/product/search.do" target="_blank">Geogratis</a> service to download a local topographic map in pdf format, and then used <a href="http://research.microsoft.com/en-us/um/redmond/projects/mapcruncher/" title="MapCruncher from Microsoft Research" target="_blank">MapCruncher</a> from Microsoft Research to prepare it in a format so that it can be used with Bing. The details on how to do this are available from <a href="http://msdn.microsoft.com/en-us/library/gg427610.aspx" title="Bing Maps v7.0 API" target="_blank">MSDN</a> for interested web geeks, but it's probably not of any interest to anyone else.</p>  
<h2>Gallery</h2>
High resolution images are available from <a href="http://www.flickr.com/photos/planetmarshall/sets/72157627766646674/" title="Flickr : Vancouver" target="_blank">Flickr</a>.
[nggallery id=16]</p>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1147</wp:post_id>
		<wp:post_date>2011-10-01 18:36:38</wp:post_date>
		<wp:post_date_gmt>2011-10-01 18:36:38</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>vancouver</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="hiking"><![CDATA[Hiking]]></category>
		<category domain="category" nicename="hiking"><![CDATA[Hiking]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>dsq_thread_id</wp:meta_key>
			<wp:meta_value><![CDATA[432299489]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>220</wp:comment_id>
			<wp:comment_author><![CDATA[David Sharpe]]></wp:comment_author>
			<wp:comment_author_email></wp:comment_author_email>
			<wp:comment_author_url>http://www.facebook.com/profile.php?id=689450292</wp:comment_author_url>
			<wp:comment_author_IP>213.106.5.87</wp:comment_author_IP>
			<wp:comment_date>2011-10-10 18:50:00</wp:comment_date>
			<wp:comment_date_gmt>2011-10-10 18:50:00</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Looks like a great walk, added to the list.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[331121527]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>223</wp:comment_id>
			<wp:comment_author><![CDATA[planetmarshall]]></wp:comment_author>
			<wp:comment_author_email>planetmarshalluk@hotmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>194.247.82.76</wp:comment_author_IP>
			<wp:comment_date>2011-10-11 12:55:00</wp:comment_date>
			<wp:comment_date_gmt>2011-10-11 12:55:00</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Cheers Dave.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>220</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
			<wp:commentmeta>
				<wp:meta_key>dsq_parent_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[331121527]]></wp:meta_value>
			</wp:commentmeta>
			<wp:commentmeta>
				<wp:meta_key>dsq_post_id</wp:meta_key>
				<wp:meta_value><![CDATA[331617712]]></wp:meta_value>
			</wp:commentmeta>
		</wp:comment>
	</item>
	<item>
		<title>My First Full Scottish Winter Season</title>
		<link>http://www.planetmarshall.co.uk/2013/04/my-first-full-scottish-winter-season/</link>
		<pubDate>Mon, 01 Apr 2013 14:00:31 +0000</pubDate>
		<dc:creator>Andrew</dc:creator>
		<guid isPermaLink="false">http://www.planetmarshall.co.uk/?p=1678</guid>
		<description></description>
		<content:encoded><![CDATA[[singlepic id=183 float=right w=200]As I write this, the Scottish winter is not just hanging in there, it's colder now than it was in any of the Winter months and it's likely I could yet get some more winter routes in the bag before the season is over, however I wanted to write this up while the memories were still fresh.

A couple of caveats - I've been in the Scottish Hills in Winter before, and as is often said there's no such thing as Scottish Winter Hillwalking, only Mountaineering. That said, prior to this Winter my only experience of Scottish Winter Climbing was being guided up the Grade II North Gully on Ben Nevis at the end of a particularly foul week, weatherwise, in February 2012. So this is pretty much my first full season of Scottish Winter Climbing.

Probably one of the best ways to get out into the mountains as much as possible is to join a local mountaineering club. I'm a member of the <a title="Jacobites Mountaineering Club" href="https://sites.google.com/site/newjacobitesmountaineeringclub/" target="_blank">Jacobites Mountaineering Club</a> based in Edinburgh, a motley bunch of Munro and Corbett baggers, climbers, alpinists and ski mountaineers. In addition, I took a couple of weeks out to do some guided climbing with <a title="Moran Mountain" href="http://www.moran-mountain.co.uk/" target="_blank">Martin Moran</a>, based in Strathcarron in the North West, and also with <a title="Jagged Globe" href="http://www.jagged-globe.co.uk/" target="_blank">Jagged Globe</a>, based out of Ballachulish.

<!--more-->
<h3>The A'Chioch Ridge (II,***)</h3>
[singlepic id=185 float=left w=200] After a couple of days on some lower grade objectives, the plan was for a route on Beinn Bhan - the <a title="Cold Climbs by Ken Wilson" href="http://www.amazon.co.uk/Cold-Climbs-Great-British-Yourself/dp/0906371163" target="_blank">Cold Climbs</a> classic 'March Hare's Gully' (IV,4,***), but the initial steep ice pitch was to prove a bit much too soon, and remains something I hope to return to now that I've had more practice. The consolation prize was a traverse of the A'Chioch ridge. Not technically difficult, but stunning scenery along the entire route.
<h3>Turquoise Gully (III,*)</h3>
[singlepic id=192 float=right w=150]I was feeling a bit dejected after failing on March Hare's gully, so the next day we headed to Meall Gorm, and Turquoise Gully. A great climb that merits more than its single star in the SMC selected Winter Climbs book. Although, that may be coloured by the fact that the base of the climb lies barely 15 minutes walk from the car park. After practicing some skills on a top rope in the car park, we left our rucksacks by the car and walked to the base of the route. The initial pitch, led by <a title="Alpha Mountaineering" href="http://www.alphamountaineering.co.uk/" target="_blank">Nick Carter</a>, had an imposing 'ice mushroom' feature, or shroud, caused by high winds in the direction of the gully. I was a bit nervous of this feature having considered the initially steep ice of March Hare’s to be less difficult – however I passed it without any problems. I left the route feeling satisfied, and keen to get back to Beinn Bhan to have another go at March Hare’s Gully, though perhaps that will now have to wait for next winter.
<h3>Tower Ridge (IV,3,****)</h3>
[singlepic id=188 float=left h=150]Having had some instruction in leading winter routes, I was keen to put it to good use and my opportunity would come at the inaugural <a title="Scottish Winter Climbing Meet" href="http://www.scottishwinterclimbing.co.uk/" target="_blank">Scottish Winter Climbing Meet</a>, organised by <a title="Mountain Motion" href="http://www.mountainmotion.co.uk/" target="_blank">Richard Bentley</a>. My partner for the weekend would be fellow Jacobite, Victor Manazares. On the Friday night before climbing we got some local info from <a title="Abacus Moutaineering" href="http://www.abacusmountaineering.com/" target="_blank">Mike Pescod</a> on which routes were in condition, but I had heard the phrase 'Tower Ridge' and could think of little else. Victor took some persuading, but he relented and the climb was on for the following morning. Arriving at the CIC hut, we saw that the path to the ridge had been well trod and visibility excellent - both signs which bode well for what would be my first winter lead without the assistance of a guide. We saw that most parties had opted to skip the initial gully that separates the ridge from the Douglas Boulder, and we took this as a sign that we should do the same. The route was busy and required waiting at some of the trickier points, but visibility remained excellent. I led the slightly hairy Eastern Traverse and Tower Gap, involving a short but intimidating down climb but I resisted the temptation to use the in-situ sling for aid. We topped out on a clear summit at about 5pm.

Postscript – Victor’s car had some difficulty escaping from the top car park and as a result we had to leave it and walk back down to the main road. I stuck out a thumb and flagged down a passing Range Rover, driven by none other than Tom, the owner of the Ben Nevis Inn, where we happened to be staying and the base for the meet that evening.
<h3>The Curtain (IV,5,***)</h3>
On the inside page of the current SMC Winter Climbs guidebook, there's a picture of a climber on a steeply inclined icefall with the Ben Nevis cliffs in the background. This is 'The Curtain', and it is spectacular. This would be my first Grade IV ice climb since my failing at Beinn Bhan, and was in fact a degree harder in technical difficulty. There were to be no problems here, however – the ice was solid and had seen so much traffic that it often felt like a ladder to the top. Two excellent pitches finishing on Ledge Route above made the perfect introduction to ice climbing on Ben Nevis.
<h3>Point Five Gully (V,5,****)</h3>
[singlepic id=201 float=right h=200]After the previous day’s success on The Curtain I was buzzing, and when it came to discussing objectives for the next day, I tentatively suggested Point 5. I fully expected to be told it would be too much of a step up and was somewhat surprised to be told it would be an entirely appropriate choice, and wondered what I had gotten myself into.

[singlepic id=197 float=left w=150]Another of Ken Wilson's 'Cold Climbs', Point 5 was the undisputed highlight of my winter. Andy Owen of Jagged Globe took on all the leading here, but even seconding would prove to be a challenge. The pitches were steep, sustained and strenuous and would prove to be a test of how I would be able to ice climb as efficiently as possible. The entire route was armour-plated in solid ice, forcing Andy to be a bit ‘creative’ at times with belays.Leading a route like this is beyond my abilities for the moment, though it remains a tentative goal for next season.
<h3>Ice Crew (III,**)</h3>
[singlepic id=198 float=right h=150]With a change in the weather we went for the lower lying Beinn Udlaidh, a great ice climbing venue in cold conditions but we were to see it, or rather not see it, in a day of thaw and poor visibility. With the noise of falling ice all around I would not have gone near the place without a guide of Andy’s experience, and he concurred that that would have been a sensible decision. However we would not be deterred, and climbed the fine, though wet, ‘Ice Crew’. In more benign conditions I would have led this as Andy could have soloed ( He would later solo Orion Direct during two weeks of stunning alpine conditions in late February ) but on this occasion I was more than happy to let Andy go up first. Ice cold water poured down from every icicle, but it’s a fine climb, and I would be happy to return to this venue. The neighbouring ‘Quartzvein Scoop’ (IV,4) is a reputed classic.
<h3>Raeburn's Route (IV,4,***)</h3>
[singlepic id=199 float=left w=150]Harold Raeburn was a prolific climber, and so there are a plethora of routes that bear his name. Confusingly, there are two on Stob Corrie Nan Lochan. Known as 'Raeburn's Route' in the SMC guide, this is also known as 'Raeburn's Ordinary Route', not to be confused with 'Ordinary Route' on the same crag. With ice climbing being the theme for the week so far, I was keen to try some mixed climbing. I found myself to be far more comfortable with this style of climbing than with pure ice, but nonetheless I was to take a fall near the top of the route. I console myself that I had gone the wrong way and had taken a harder technical variation than was standard.
<h3>George (III,4,**)</h3>
My first lead of a Scottish Winter gully climb. For me, this is what it's all been leading up to. I don't want to continue my climbing career being guided up things, far better to experience both the physical and psychological stress of climbing 'at the sharp end'. Although I had led on Tower Ridge, that climb earns its grade from its length rather than its difficulty. I was expecting George to be a typical, though excellent, example of a Scottish Winter gully climb, more serious and technical, and I was not to be disappointed.

The Jacobites have a hut, <a href="https://sites.google.com/site/newjacobitesmountaineeringclub/club-hut" target="_blank">Inver Croft</a>, near Achnasheen in the North West highlands. It is perfectly located for climbs in the Torridion area, and that is where I and two friends headed on a weekend in early March that would also host the club’s Whisky tasting event. It wasn’t the finest of weather, and I would have liked to have better visibility, but ‘George’ is undeniably a fantastic climb. Nick and I shared leads to the top, we took the standard route rather than the harder ‘Sinister Prong’ variation, but nonetheless found the characteristic cave feature to be buried. During a slightly tricky manoeuvre I dropped one of Nick’s ice screws, and was delighted to receive it in the post a few weeks later after I contacted a climber on <a href="http://www.ukclimbing.com/" target="_blank">UKC</a> who had climbed the route the following day.

<span style="font-size: 13px;"> </span>
<h2>An Teallach</h2>
[singlepic id=189 float=right h=150] Despite a return to cold weather in late March, I was unable to get out for further climbing until the Easter weekend. I arranged with another Jacobite, Pete, to head back up to Inver with the aim of doing one of the major ridges. I suggested An Teallach, as I hadn’t been there before. Pete’s not a climber, but nonetheless it wasn’t difficult to persuade him to try an ascent of ‘Chockstone Gully’ (I), which would allow us to approach via Toll an Lochain, which is a sight to behold.
<h3><span style="font-size: 1.17em;">Chockstone Gully (I,*)</span></h3>
[singlepic id=193 float=left h=175]After fighting through the Rhodedendrons opposite Dundonell House, we began the long (2 hours) walk to Toll an Lochain. The ascent up the gully was solid, so we didn’t bother to rope up and made good time to the ridge. The view from the ridge is hidden while ascending until the very last moment, when it is a spectacular reveal, with Beinn Dearg figuring prominently to the south.
<h3>Ridge Traverse (II,****)</h3>
[singlepic id=202 float=right h=150]The views from the ridge are spectacular, however the normally Grade II pinnacles were not really in appropriate condition for winter climbing, having been stripped dry by the spring sun. In addition the turf was unfrozen and the snow soft and powdery. As it was we avoided much of the difficulty, though made it back up to the crest where possible to take in more of the scenery.

With time pressing, and neither of us being munro baggers we opted to skip the final munro and descend from the col at the head of Glas Tholl. Although suggested by the guide book, this seemed excessively steep and corniced to me, so we continued along the ridge until we reached a more forgiving gradient. I wasn’t aware of the descent via ‘Hayfork Gully’, which I have noted for future reference.
<h2>Epilogue</h2>
As I hoped, I was able to get one more winter route done before packing up the axes and crampons, and what a route it was.
<h3>Crowberry Gully (IV,4,****)</h3>
[singlepic id=204 w=200 float=left]Rob and I headed out at 5am from Edinburgh for a day trip to Glencoe to bag one more Cold Climbs classic, and my first (IV,4) lead. From following the <a title="#scotwinter" href="https://twitter.com/search?q=%23scotwinter&amp;src=typd" target="_blank">#scotwinter</a> feed on twitter I was aware that it had seen lots of traffic this week. We were at the base of the route by 8am but even so there was a party already ahead, and several behind. The ice was thin in places, and we considered the thin traverse before the cave pitch to be tougher than the usual crux, the cave pitch itself, which Rob generously let me lead.

The descent was almost as much fun as the climb itself, a smooth glissade down almost the entirety of Great Gully, bringing us from the summit of Buachaille Etive Mor to the car in under an hour.
<h2>What Next?</h2>
Climbing amongst the dry Torridonian sandstone in the spring sunshine last week and my thoughts were already turning to rock rather than ice, but next years goals are really just to increase the mileage on grade IV routes, though if I could up my game to leading a grade V that would be a great achievement for me. I'd also like to try some more mixed climbs, and I haven't yet paid a visit to Coire Mhic Fhearchair on Beinn Eighe, though that goal remains tantalisingly within reach for this winter while the temperatures are still low.

For the full image gallery, see my <a title="Scottish Winter" href="https://plus.google.com/photos/111007392474500551607/albums/5837889864696248273?authkey=CPjYlIPc_9S6cw" target="_blank">gallery on Google+</a>
[nggallery id=20]]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>1678</wp:post_id>
		<wp:post_date>2013-04-01 14:00:31</wp:post_date>
		<wp:post_date_gmt>2013-04-01 14:00:31</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>my-first-full-scottish-winter-season</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="climbing"><![CDATA[Climbing]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[2]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>fb_author_post_id</wp:meta_key>
			<wp:meta_value><![CDATA[643450341_510958128966595]]></wp:meta_value>
		</wp:postmeta>
	</item>
</channel>
</rss>
